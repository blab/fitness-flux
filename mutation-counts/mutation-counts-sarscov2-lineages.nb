(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58458,       1282]
NotebookOptionsPosition[     52514,       1185]
NotebookOutlinePosition[     52978,       1203]
CellTagsIndexPosition[     52935,       1200]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Mutation counts across SARS-CoV-2 lineages", "Title",
 CellChangeTimes->{{3.797453305517955*^9, 3.7974533217165728`*^9}, {
  3.817569178807376*^9, 3.817569191074053*^9}, {3.817760673111555*^9, 
  3.817760675176888*^9}, {3.818094668918388*^9, 3.8180946689780293`*^9}, {
  3.8199127595021057`*^9, 3.81991276136596*^9}, {3.8210309664789667`*^9, 
  3.821030989432283*^9}, {3.846077689233448*^9, 3.846077699256536*^9}, {
  3.939749515479649*^9, 3.9397495199099617`*^9}, {3.948384882637341*^9, 
  3.948384889221553*^9}},ExpressionUUID->"e3be259b-4491-4d3b-94d2-\
629861f79fba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7974545813376017`*^9, 3.797454587645255*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"24a66294-bbbb-4763-a43e-e1bbfe9466d5"],

Cell[BoxData["\<\"/Users/trvrb/Documents/src/fitness-flux/mutation-counts\"\>\
"], "Output",
 CellChangeTimes->{
  3.7974545882295437`*^9, 3.797458996655264*^9, 3.797620372541424*^9, 
   3.798927886069723*^9, 3.7989414217405243`*^9, 3.799115153849678*^9, 
   3.805591977220581*^9, 3.8055921951853857`*^9, 3.817569192810801*^9, 
   3.817686011290374*^9, 3.817760481997343*^9, 3.817760678835218*^9, 
   3.8177614346431293`*^9, 3.8179045819159393`*^9, 3.817904646834559*^9, 
   3.817997849766459*^9, 3.817997902126288*^9, 3.8179979393519993`*^9, 
   3.8179983899215593`*^9, 3.818085461651963*^9, 3.818094671590152*^9, 
   3.818118517395598*^9, 3.8181185531055183`*^9, 3.8198517144300623`*^9, 
   3.8198981133071203`*^9, 3.8199122405791807`*^9, 3.8199125726838512`*^9, 
   3.819912630436667*^9, 3.819912815214406*^9, 3.819914427138468*^9, 
   3.819921372752407*^9, 3.8199747374248543`*^9, 3.81997514187027*^9, 
   3.819975279963725*^9, 3.819975375407707*^9, 3.8199754200944033`*^9, 
   3.8200944911184263`*^9, 3.8200947265391808`*^9, 3.820106634293172*^9, 
   3.820189291751635*^9, 3.820189464533794*^9, 3.8202830238805523`*^9, {
   3.820325462232378*^9, 3.8203254911839743`*^9}, 3.820335537673061*^9, 
   3.820411761203425*^9, 3.820610062243444*^9, 3.8206102544593*^9, 
   3.8206773582198067`*^9, 3.8206774743466454`*^9, 3.821019514972307*^9, 
   3.821030991339788*^9, 3.82129594305958*^9, 3.821296966172285*^9, 
   3.821300042599538*^9, 3.821300580781361*^9, {3.8213009849359503`*^9, 
   3.821301007010825*^9}, 3.821304279060047*^9, 3.821308661429718*^9, 
   3.821309142948077*^9, 3.821309531812315*^9, 3.821393789310543*^9, 
   3.821397348202985*^9, 3.8215726767061*^9, 3.821572825238718*^9, 
   3.821572927151888*^9, 3.821572983247714*^9, 3.8215734366784773`*^9, 
   3.821573503446158*^9, 3.821573788888906*^9, 3.821573946382979*^9, 
   3.821574027972694*^9, 3.8220109267366734`*^9, 3.822011105254651*^9, 
   3.8225222770508823`*^9, 3.824149624337473*^9, 3.825371066214137*^9, 
   3.827399791582898*^9, 3.829400346735413*^9, 3.831222807714074*^9, 
   3.8326051689423733`*^9, 3.833729064826701*^9, 3.8356475680793543`*^9, 
   3.83564761917089*^9, 3.835647712291284*^9, 3.8356477506813374`*^9, 
   3.8356477826053553`*^9, 3.836677855806484*^9, 3.838495709516399*^9, 
   3.840975041836536*^9, 3.845817170973721*^9, 3.845817268279104*^9, 
   3.845826474071885*^9, 3.8459799003467712`*^9, 3.846077704257084*^9, 
   3.846079767314481*^9, 3.851190932259955*^9, 3.854408805584223*^9, 
   3.854410970015934*^9, 3.854475148246746*^9, 3.854476457544879*^9, 
   3.858433480712585*^9, 3.86182284082448*^9, 3.861829156837557*^9, {
   3.86476980026045*^9, 3.864769818805496*^9}, 3.864769941803458*^9, 
   3.8647701023598633`*^9, 3.864770182038631*^9, 3.8661454915891247`*^9, 
   3.867454817898238*^9, 3.868992374418054*^9, 3.8689926163029537`*^9, {
   3.870703003174139*^9, 3.870703014684493*^9}, 3.8707031438700314`*^9, 
   3.8707033249218283`*^9, 3.8707036113663807`*^9, 3.8725195956361*^9, 
   3.874966100746579*^9, 3.8755720053170156`*^9, {3.8769345511296883`*^9, 
   3.8769345620515957`*^9}, 3.876935108156617*^9, 3.878925943568201*^9, {
   3.88462855970531*^9, 3.884628574883168*^9}, 3.8846286263773623`*^9, {
   3.884628663577497*^9, 3.884628690382156*^9}, 3.884628755531581*^9, {
   3.884628933338375*^9, 3.8846289448078203`*^9}, 3.884629395841201*^9, 
   3.8869473938199873`*^9, 3.891079705520667*^9, 3.891525736742771*^9, 
   3.891527087026058*^9, 3.8915272086720047`*^9, 3.891527522123534*^9, 
   3.891527790989254*^9, 3.891545662267147*^9, 3.891547841572423*^9, 
   3.9155533528870163`*^9, 3.915553432843058*^9, 3.915553482857504*^9, 
   3.93655116415304*^9, 3.936551324649465*^9, 3.936552799500641*^9, 
   3.936552858196484*^9, 3.936553918965226*^9, 3.9396684692795343`*^9, 
   3.939668923753048*^9, 3.93967203578518*^9, 3.939672409503488*^9, 
   3.9397495233250647`*^9, 3.939749959140863*^9, 3.939752179748399*^9, 
   3.939752320516922*^9, 3.939752514445373*^9, 3.948214605610026*^9, 
   3.9483826582805433`*^9, 3.948382995329439*^9, 3.948384921162294*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"788aa169-cfe7-49bd-9a71-c726d2c99830"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect mutations", "Section",
 CellChangeTimes->{{3.846077567515098*^9, 
  3.846077573290423*^9}},ExpressionUUID->"c8a6c455-e3c5-48c9-8325-\
02069724bd87"],

Cell["Strip gaps as starting and ending characters", "Text",
 CellChangeTimes->{{3.821099556767058*^9, 3.8210995587866488`*^9}, {
  3.821099661275414*^9, 
  3.821099668547217*^9}},ExpressionUUID->"8d9e2679-cd27-4b96-a235-\
c3eea09f34e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getMutations", "[", 
   RowBox[{"node_", ",", " ", "gene_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"muts", ",", "gather"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"muts", "=", 
      RowBox[{"mutations", "[", "node", "]"}]}], ";", "\n", "  ", 
     RowBox[{"gather", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"AssociationQ", "[", "muts", "]"}], ",", "\n", "    ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"muts", ",", "gene"}], "]"}], ",", 
          RowBox[{"muts", "[", "gene", "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", "\n", "    ", 
        RowBox[{"{", "}"}]}], "\n", "    ", "]"}]}], ";", "\n", "  ", 
     RowBox[{"reduceMutations", "[", 
      RowBox[{"gather", ",", "gene"}], "]"}]}]}], "\n", "  ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8210513953250732`*^9, 3.821051438937628*^9}, {
   3.821051482494287*^9, 3.821051545393381*^9}, {3.821051692242764*^9, 
   3.8210517225213118`*^9}, {3.821098456017673*^9, 3.821098461077162*^9}, {
   3.8210994635575027`*^9, 3.821099542570204*^9}, {3.8210996481935463`*^9, 
   3.8210996546494703`*^9}, 3.82130891873974*^9, {3.821309003891509*^9, 
   3.821309007937924*^9}, 3.821309134604981*^9, {3.8213092395485563`*^9, 
   3.8213092727008753`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"72da1009-5eeb-4312-93ab-f4c6b67579ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"reduceMutations", "[", 
   RowBox[{"gather_", ",", "gene_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"gene", "\[Equal]", "\"\<S\>\""}], ",", "\n", 
    RowBox[{"Cases", "[", 
     RowBox[{"gather", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "\[NotEqual]", "\"\<-\>\""}], "&&", 
        
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"x", ",", 
           RowBox[{"-", "1"}]}], "]"}], "\[NotEqual]", " ", "\"\<-\>\""}], "&&", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}], "]"}], "\[GreaterEqual]", 
         "14"}], "&&", 
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "]"}], "]"}], "\[LessEqual]", 
         " ", "685"}]}]}]}], "]"}], ",", "\n", "  ", 
    RowBox[{"Cases", "[", 
     RowBox[{"gather", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"x", ",", " ", "1"}], "]"}], "\[NotEqual]", "\"\<-\>\""}], "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"x", ",", 
           RowBox[{"-", "1"}]}], "]"}], "\[NotEqual]", " ", 
         "\"\<-\>\""}]}]}]}], "]"}]}], "\n", "  ", "]"}]}]], "Input",
 CellChangeTimes->{{3.8213089551893177`*^9, 3.821308993244701*^9}, {
   3.8213090256603394`*^9, 3.821309084122863*^9}, 3.821309140400117*^9, {
   3.821309241660768*^9, 3.8213092416714907`*^9}, {3.8213092794909897`*^9, 
   3.821309385978149*^9}, 3.822522629267374*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"cee78a38-b498-41d6-b13d-8986a53414aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getMutationHistory", "[", 
   RowBox[{"node_", ",", "gene_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "nodeList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nodeList", "=", 
      RowBox[{"NestWhileList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/.", "edges"}], "&"}], ",", "node", ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", "root"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getMutations", "[", 
          RowBox[{"#", ",", "gene"}], "]"}], "&"}], ",", "nodeList"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8210520311763067`*^9, 3.8210520797479143`*^9}, {
  3.8210521258177757`*^9, 3.821052169424679*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e8aeed6c-3d23-4227-bdc2-56a898cd22cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SARS-CoV-2 lineages", "Section",
 CellChangeTimes->{{3.891526135549386*^9, 3.891526139699115*^9}, {
  3.93974959517662*^9, 3.939749597410153*^9}, {3.9483848666212053`*^9, 
  3.948384866823433*^9}},ExpressionUUID->"430d1438-3681-4290-a52b-\
b5db8a397f8a"],

Cell[CellGroupData[{

Cell["Import data", "Subsection",
 CellChangeTimes->{{3.821031062079789*^9, 3.821031062503763*^9}, {
  3.82129625691759*^9, 3.821296261318787*^9}, {3.821300288451833*^9, 
  3.821300289717749*^9}},ExpressionUUID->"5542d0f3-2531-4f00-847a-\
b662cc1edfc8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<nextclade_sars-cov-2_flat.json\>\"", ",", "\"\<RawJSON\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821048266937048*^9, 3.821048286424429*^9}, {
   3.821048545302606*^9, 3.821048545489085*^9}, {3.821051166204458*^9, 
   3.821051166965352*^9}, {3.835647566237626*^9, 3.835647567082893*^9}, 
   3.845826479879717*^9, {3.851190929508647*^9, 3.851190931114972*^9}, {
   3.858433486772704*^9, 3.858433488869738*^9}, {3.861822833411442*^9, 
   3.8618228399358807`*^9}, 3.939749606015547*^9},
 CellLabel->"In[5]:=",ExpressionUUID->"690daa4c-9c72-4252-b9a6-8b1b411d6ab6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", "\"\<name\>\"", "]"}], "&"}], ",", "data"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.821051190260438*^9, 3.821051227585184*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"2c345237-8cd6-472a-8859-f0d77d66ed27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
          RowBox[{"#", "[", "\"\<parent\>\"", "]"}]}], "&"}], ",", "data"}], 
       "]"}], ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Null"}]}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821051233968555*^9, 3.821051279952435*^9}, {
  3.821098495347939*^9, 3.821098502299711*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"cf806e03-aee1-4827-981c-401d81d13ccc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"root", "=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
         RowBox[{"#", "[", "\"\<parent\>\"", "]"}]}], "&"}], ",", "data"}], 
      "]"}], ",", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "Null"}]}]}], "]"}], "[", 
   
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.82105198426083*^9, 3.821051995895515*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"83813a79-3c9d-4a2e-ae9f-466b088b3f71"],

Cell[BoxData["\<\"NODE_0000000\"\>"], "Output",
 CellChangeTimes->{{3.821051985651328*^9, 3.821051996377685*^9}, 
   3.8210523911751003`*^9, 3.821100311874734*^9, 3.821295943422822*^9, 
   3.821296966402195*^9, 3.821300042839336*^9, 3.8213005810379457`*^9, {
   3.8213009852040863`*^9, 3.821301007253015*^9}, 3.821303647213315*^9, 
   3.8213041285774717`*^9, 3.821304279306775*^9, {3.821308632727558*^9, 
   3.821308661671544*^9}, 3.821308708795404*^9, 3.821309143155498*^9, 
   3.821309245242429*^9, {3.8213093919971867`*^9, 3.821309402240981*^9}, 
   3.821309532056683*^9, 3.82139378959332*^9, 3.821397348535112*^9, 
   3.821572678769374*^9, 3.8215728255403214`*^9, 3.821572927472673*^9, 
   3.8215729836272182`*^9, 3.821573437013328*^9, 3.82157350383183*^9, 
   3.821573789278592*^9, 3.821573946782857*^9, 3.821574028407452*^9, 
   3.8220109311311502`*^9, 3.82201110558827*^9, 3.822522284590703*^9, 
   3.824149634026922*^9, 3.8253710665615263`*^9, 3.827399815679532*^9, 
   3.827399861200886*^9, 3.829400350373437*^9, 3.829400426467722*^9, 
   3.8312228136550293`*^9, 3.8326051739359827`*^9, 3.832605307283143*^9, 
   3.832605358963395*^9, 3.833729065758155*^9, 3.835647569661964*^9, 
   3.8356476194093122`*^9, 3.8356477124898767`*^9, 3.835647750901532*^9, 
   3.835647782783231*^9, 3.8366778594662027`*^9, 3.8384957119601707`*^9, 
   3.8384957919115877`*^9, 3.840975043436941*^9, 3.8458171787022343`*^9, 
   3.8458172684090223`*^9, 3.845817983219933*^9, 3.845826484014386*^9, {
   3.845979903386674*^9, 3.845979916823641*^9}, 3.8460777965656767`*^9, 
   3.846077975994151*^9, 3.8460797677115803`*^9, 3.851190932474516*^9, 
   3.854408805795487*^9, 3.85441098935076*^9, 3.8544751502946033`*^9, 
   3.854476459785359*^9, 3.858433492915968*^9, 3.861822841052511*^9, 
   3.861829156987947*^9, {3.864769800494246*^9, 3.864769818979866*^9}, 
   3.864769941934992*^9, 3.864770102475668*^9, 3.864770182133836*^9, 
   3.866145494338983*^9, 3.8674548180757647`*^9, 3.8689923778258657`*^9, 
   3.868992620707796*^9, {3.8707030033881807`*^9, 3.8707030148584137`*^9}, 
   3.870703144018095*^9, 3.8707033272720203`*^9, 3.870703611537553*^9, 
   3.872519597806098*^9, 3.87496610093384*^9, 3.8755720054795523`*^9, 
   3.876934562800621*^9, 3.876935119563265*^9, 3.878925949067746*^9, {
   3.884628559869256*^9, 3.88462857506501*^9}, 3.8846286264935293`*^9, {
   3.884628663700398*^9, 3.88462869049155*^9}, 3.8846287556432133`*^9, {
   3.8846289335063477`*^9, 3.8846289449536448`*^9}, 3.884629395947009*^9, 
   3.886947394041761*^9, 3.891079705743576*^9, 3.8915257510050793`*^9, 
   3.8915272087801323`*^9, 3.891527522240437*^9, 3.891527791094326*^9, 
   3.891545662439501*^9, 3.891547791094947*^9, 3.891547841691255*^9, 
   3.915553358683893*^9, 3.915553437838151*^9, 3.915553483196701*^9, 
   3.936551164363365*^9, 3.9365515724930563`*^9, 3.936552023039839*^9, 
   3.936552800138342*^9, 3.936552858788583*^9, 3.9365539292274103`*^9, 
   3.9396684699239473`*^9, 3.939668924363144*^9, 3.939672036447748*^9, 
   3.9396721249479647`*^9, 3.939672155416519*^9, 3.939672410095015*^9, 
   3.939749610676276*^9, 3.939749959495553*^9, 3.9397521800808496`*^9, 
   3.939752320802719*^9, 3.939752514706294*^9, 3.948214605842684*^9, 
   3.948383012126615*^9, 3.9483849213046913`*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"aeac0861-94d7-48d1-aaec-83b01c8cea77"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutations", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
        RowBox[{"#", "[", "\"\<mutations\>\"", "]"}]}], "&"}], ",", "data"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821051337838971*^9, 3.821051349960338*^9}, 
   3.8210517499621773`*^9, {3.8210983989751387`*^9, 3.8210984409932756`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"ef613151-d991-48ad-8db2-e09a51835309"],

Cell[BoxData[
 RowBox[{
  RowBox[{"clades", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
        RowBox[{"#", "[", "\"\<clade_membership\>\"", "]"}]}], "&"}], ",", 
      "data"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821100314475768*^9, 3.821100327057871*^9}, {
  3.939749622798458*^9, 3.939749624983396*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"eb305b5e-1463-4ad0-8747-e6109a484ec3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineages", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
        RowBox[{"#", "[", "\"\<Nextclade_pango\>\"", "]"}]}], "&"}], ",", 
      "data"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821100314475768*^9, 3.821100327057871*^9}, {
  3.939672130105875*^9, 3.9396721378748713`*^9}, {3.93974962742452*^9, 
  3.93974963535518*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"44e2ae40-3174-4fd0-9093-1f106957c3ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nucCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<name\>\"", "]"}], "\[Rule]", 
        RowBox[{"#", "[", "\"\<div\>\"", "]"}]}], "&"}], ",", "data"}], "]"}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821100314475768*^9, 3.821100327057871*^9}, {
  3.846077886206339*^9, 3.846077892792789*^9}, {3.936553935856422*^9, 
  3.936554012104219*^9}, {3.939749655312446*^9, 3.93974965761793*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"939467e5-fc88-4cce-9be8-e9a061fa0a41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tips", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"nodes", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"x", ",", 
         RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], "\[NotEqual]", 
       "\"\<NODE_\>\""}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821098626302855*^9, 3.821098639690777*^9}, {
  3.8210986728599586`*^9, 3.8210986896076*^9}, {3.939749736629945*^9, 
  3.939749738600848*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"002b0022-3fb6-4aac-8005-cd241a60f925"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "tips", "]"}]], "Input",
 CellChangeTimes->{{3.821098691006597*^9, 3.8210986939078407`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"87d96043-b604-4f24-9a33-279a394cef6b"],

Cell[BoxData["3775"], "Output",
 CellChangeTimes->{
  3.821098694495757*^9, {3.821100311960428*^9, 3.821100329564438*^9}, 
   3.821295943529811*^9, 3.821296966469573*^9, 3.821300042912657*^9, 
   3.82130058111543*^9, {3.821300985286064*^9, 3.821301007318082*^9}, 
   3.821303647324127*^9, 3.821304128674122*^9, 3.821304279380425*^9, {
   3.8213086328914423`*^9, 3.821308661747081*^9}, 3.8213087089044228`*^9, 
   3.821309143208848*^9, 3.8213092453442707`*^9, {3.821309392121772*^9, 
   3.8213094023313103`*^9}, 3.821309532125905*^9, 3.82139378967381*^9, 
   3.821397348652693*^9, 3.821572678891926*^9, 3.821572825631597*^9, 
   3.821572927566177*^9, 3.821572983719014*^9, 3.821573437109091*^9, 
   3.8215735039313517`*^9, 3.821573789369665*^9, 3.821573946874861*^9, 
   3.821574028512018*^9, 3.8220109312435217`*^9, 3.8220111056815987`*^9, 
   3.822522284742708*^9, 3.8241496341787243`*^9, 3.825371066662654*^9, 
   3.827399815741804*^9, 3.827399861277137*^9, 3.829400350461492*^9, 
   3.829400426538253*^9, 3.831222813760273*^9, 3.832605174168996*^9, 
   3.832605307356073*^9, 3.832605359040922*^9, 3.8337290659191437`*^9, 
   3.835647569734962*^9, 3.835647619453424*^9, 3.8356477125388727`*^9, 
   3.835647750969543*^9, 3.835647782829295*^9, 3.8366778596459312`*^9, 
   3.8384957120136423`*^9, 3.8384957919826403`*^9, 3.840975043532625*^9, 
   3.845817178756506*^9, 3.845817268444618*^9, 3.845817983272995*^9, 
   3.845826484085168*^9, {3.8459799034511414`*^9, 3.845979916888199*^9}, 
   3.846077796703732*^9, 3.8460779761873693`*^9, 3.846079767860343*^9, 
   3.8511909325544558`*^9, 3.854408805874308*^9, 3.8544109894201403`*^9, 
   3.854475150366691*^9, 3.8544764598531027`*^9, 3.8584334929923677`*^9, 
   3.8618228411199217`*^9, 3.861829157028441*^9, {3.864769800535695*^9, 
   3.864769819018422*^9}, 3.8647699419795923`*^9, 3.864770102516341*^9, 
   3.864770182177593*^9, 3.866145494546978*^9, 3.867454818117432*^9, 
   3.8689923779361753`*^9, 3.8689926209443398`*^9, {3.870703003432303*^9, 
   3.870703014896036*^9}, 3.870703144074321*^9, 3.8707033273124723`*^9, 
   3.870703611578347*^9, 3.872519597905429*^9, 3.874966100973806*^9, 
   3.875572005522608*^9, 3.876934563008753*^9, 3.876935119747636*^9, 
   3.878925949260571*^9, {3.884628559907305*^9, 3.8846285751066637`*^9}, 
   3.884628626535866*^9, {3.884628663742625*^9, 3.884628690530809*^9}, 
   3.884628755683063*^9, {3.884628933544716*^9, 3.884628944996819*^9}, 
   3.884629395986314*^9, 3.886947394082691*^9, 3.891079705781663*^9, 
   3.891525751060419*^9, 3.891527208825777*^9, 3.891527522278311*^9, 
   3.891527791131713*^9, 3.891545662481868*^9, 3.8915477911365128`*^9, 
   3.8915478417327623`*^9, 3.915553358765555*^9, 3.915553437897025*^9, 
   3.915553483251965*^9, 3.936551164404421*^9, 3.936551576057019*^9, 
   3.936552026657192*^9, 3.936552800177299*^9, 3.936552858825223*^9, 
   3.936553933629936*^9, 3.936553986658187*^9, 3.939668469984456*^9, 
   3.9396689244165277`*^9, 3.939672036516486*^9, 3.939672125015456*^9, 
   3.939672155483686*^9, 3.9396724101493797`*^9, 3.9397497432064743`*^9, 
   3.939749959529845*^9, 3.9397521820089293`*^9, 3.939752320830607*^9, 
   3.9397525147347307`*^9, 3.948214605869876*^9, 3.948383012161742*^9, 
   3.948384921340251*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"c878a663-90de-4b67-b94a-51754c955305"]
}, Open  ]],

Cell["S1 is 671 AA in length", "Text",
 CellChangeTimes->{{3.851613666863365*^9, 
  3.851613673044348*^9}},ExpressionUUID->"f83784bb-988c-49cc-9343-\
a86aa0ec3091"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Collect mutations", "Subsection",
 CellChangeTimes->{{3.821297520033966*^9, 
  3.821297521845119*^9}},ExpressionUUID->"006e2e57-9751-4cf7-ae70-\
e141167411ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getMutationHistory", "[", 
  RowBox[{
   RowBox[{"nodes", "[", 
    RowBox[{"[", "200", "]"}], "]"}], ",", "\"\<S\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.821052198347291*^9, {3.821297524922217*^9, 3.821297526360948*^9}, 
   3.939749842998115*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"d9381fe8-4fe2-4820-afed-b6af19a68c1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"M153I\"\>", ",", "\<\"A27S\"\>", ",", "\<\"G142D\"\>", 
   ",", "\<\"K147E\"\>", ",", "\<\"W152R\"\>", ",", "\<\"F157L\"\>", 
   ",", "\<\"I210V\"\>", ",", "\<\"V213G\"\>", ",", "\<\"G257S\"\>", 
   ",", "\<\"G339H\"\>", ",", "\<\"R346T\"\>", ",", "\<\"S371F\"\>", 
   ",", "\<\"S373P\"\>", ",", "\<\"S375F\"\>", ",", "\<\"T376A\"\>", 
   ",", "\<\"D405N\"\>", ",", "\<\"R408S\"\>", ",", "\<\"K417N\"\>", 
   ",", "\<\"N440K\"\>", ",", "\<\"G446S\"\>", ",", "\<\"N460K\"\>", 
   ",", "\<\"S477N\"\>", ",", "\<\"T478K\"\>", ",", "\<\"E484A\"\>", 
   ",", "\<\"F486P\"\>", ",", "\<\"F490S\"\>", ",", "\<\"Q498R\"\>", 
   ",", "\<\"N501Y\"\>", ",", "\<\"Y505H\"\>", ",", "\<\"D614G\"\>", 
   ",", "\<\"H655Y\"\>", ",", "\<\"N679K\"\>", ",", "\<\"P681H\"\>", 
   ",", "\<\"T19I\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.821052198861946*^9, 3.821098478084814*^9, 3.8210985140203037`*^9, 
   3.821099571406139*^9, 3.8210996573992043`*^9, 3.821295943577848*^9, 
   3.8212969665191803`*^9, 3.821297526924251*^9, 3.821298205890873*^9, 
   3.8212989410296993`*^9, 3.821299162225984*^9, 3.821299288496883*^9, 
   3.8212998559877377`*^9, 3.821300046984762*^9, 3.8213005855166407`*^9, {
   3.821300990047393*^9, 3.82130101206807*^9}, 3.821304283885497*^9, {
   3.8213085723235807`*^9, 3.8213085912708263`*^9}, 3.821308665989799*^9, 
   3.8213091474251423`*^9, 3.8213095366724157`*^9, 3.821309711618392*^9, 
   3.8213937950522346`*^9, 3.8213973535664043`*^9, 3.821572687093226*^9, 
   3.821572832302636*^9, 3.821572935830792*^9, 3.821572989772917*^9, 
   3.821573443303206*^9, 3.8215735105874853`*^9, 3.821573795775872*^9, 
   3.821573954536663*^9, 3.821574037255309*^9, 3.822011112358828*^9, 
   3.8253710848755627`*^9, 3.8273998263013487`*^9, 3.829400367396968*^9, 
   3.833729108029859*^9, 3.8356476371897497`*^9, 3.835647730077097*^9, 
   3.835647768672277*^9, 3.835647800425515*^9, 3.8366778943277407`*^9, 
   3.838495728398404*^9, 3.840975061838018*^9, 3.845817280197174*^9, 
   3.846077526185157*^9, 3.8460776295711412`*^9, 3.854409593613577*^9, 
   3.8544096380055304`*^9, 3.854410396367975*^9, 3.854474563875127*^9, 
   3.854474871981139*^9, 3.854474943754105*^9, 3.8544749963859243`*^9, 
   3.854476390372614*^9, 3.8544764383218307`*^9, 3.858433685402248*^9, 
   3.86182918739705*^9, 3.864769919412264*^9, 3.864769955166894*^9, 
   3.864770020950162*^9, 3.864770072147944*^9, 3.8647701183320837`*^9, 
   3.8647701942331257`*^9, 3.864770375856592*^9, 3.8689924896147957`*^9, 
   3.870703472919849*^9, 3.870703559289006*^9, 3.870703638244748*^9, 
   3.884628824605577*^9, 3.88462941581376*^9, 3.886947656469943*^9, 
   3.891079765458601*^9, 3.9368885029155617`*^9, 3.936888712710898*^9, 
   3.936889226752494*^9, 3.9396684167370977`*^9, 3.9397498434138727`*^9, 
   3.9397499595333233`*^9, 3.9397521820118732`*^9, 3.939752320833386*^9, 
   3.939752514739746*^9, 3.9482146058729057`*^9, 3.9483830186275873`*^9, 
   3.948384921344203*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"3bc78d44-0b02-4b00-824e-1539f86a5c5d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1Mutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "spikeMuts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spikeMuts", "=", 
      RowBox[{"getMutationHistory", "[", 
       RowBox[{"node", ",", "\"\<S\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Count", "[", 
      RowBox[{"spikeMuts", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], ">=", "14"}], "&&", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], "<=", "685"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948383331074753*^9, 3.9483833511383257`*^9}, {
  3.948383478232483*^9, 3.948383501646915*^9}, {3.948383535916501*^9, 
  3.948383536973465*^9}, {3.9483836938030567`*^9, 3.9483837176396008`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"122d14be-9120-4806-96dd-559c5a8aebe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s2Mutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "spikeMuts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spikeMuts", "=", 
      RowBox[{"getMutationHistory", "[", 
       RowBox[{"node", ",", "\"\<S\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Count", "[", 
      RowBox[{"spikeMuts", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], ">=", "686"}], "&&", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], "<=", "1273"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948383331074753*^9, 3.9483833511383257`*^9}, {
  3.948383478232483*^9, 3.948383501646915*^9}, {3.948383535916501*^9, 
  3.948383536973465*^9}, {3.9483836938030567`*^9, 3.9483837577018547`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"aa24bef5-a421-4ca9-b63e-61e52e3970e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntdMutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "spikeMuts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spikeMuts", "=", 
      RowBox[{"getMutationHistory", "[", 
       RowBox[{"node", ",", "\"\<S\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Count", "[", 
      RowBox[{"spikeMuts", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], ">=", "14"}], "&&", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], "<=", "305"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948383331074753*^9, 3.9483833511383257`*^9}, {
  3.948383478232483*^9, 3.948383501646915*^9}, {3.948383535916501*^9, 
  3.948383536973465*^9}, {3.9483836938030567`*^9, 3.9483837176396008`*^9}, {
  3.948384470844872*^9, 3.94838448336719*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"5c92cd28-5412-48e4-837d-e71195fb93b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rbdMutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "spikeMuts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spikeMuts", "=", 
      RowBox[{"getMutationHistory", "[", 
       RowBox[{"node", ",", "\"\<S\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Count", "[", 
      RowBox[{"spikeMuts", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], ">=", "319"}], "&&", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringTake", "[", 
            RowBox[{"x", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}]}], "]"}], "]"}], "<=", "541"}]}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948383331074753*^9, 3.9483833511383257`*^9}, {
  3.948383478232483*^9, 3.948383501646915*^9}, {3.948383535916501*^9, 
  3.948383536973465*^9}, {3.9483836938030567`*^9, 3.9483837176396008`*^9}, {
  3.948384470844872*^9, 3.948384504597269*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"dc11c297-ac6f-4c0b-9cc7-bd419f4fedb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"orf1abMutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"orf1aMuts", ",", "orf1bMuts"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orf1aMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF1a\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf1bMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF1b\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf1aMuts", "+", "orf1bMuts"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.948383767941951*^9, 3.948383799427763*^9}, {
  3.948383853609312*^9, 3.948383867116289*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"9b5283f7-d05d-469d-9930-dcd60d4cb4ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"accessoryMutations", "[", "node_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "orf3aMuts", ",", "eMuts", ",", "mMuts", ",", "orf6Muts", ",", 
      "orf7aMuts", ",", "orf7bMuts", ",", "orf8Muts", ",", "nMuts"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orf3aMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF3a\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<E\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<M\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf6Muts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF6\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf7aMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF7a\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf7bMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF7b\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orf8Muts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<ORF8\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nMuts", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"getMutationHistory", "[", 
        RowBox[{"node", ",", "\"\<N\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "orf3aMuts", "+", "eMuts", "+", "mMuts", "+", "orf6Muts", "+", 
      "orf7aMuts", "+", "orf7bMuts", "+", "orf8Muts", "+", "nMuts"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948383767941951*^9, 3.948383799427763*^9}, {
  3.948383853609312*^9, 3.9483839706016607`*^9}, {3.948384001182374*^9, 
  3.948384146271925*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"8b39f722-4956-4dc7-9356-c4d38ea891fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nucCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"getMutationHistory", "[", 
          RowBox[{"#", ",", "\"\<nuc\>\""}], "]"}], "]"}]}], "&"}], ",", 
      "nodes"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.939752195497785*^9, 
  3.939752200657682*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"7e52026c-9fa6-4444-97a7-2b3074a81099"],

Cell[BoxData[
 RowBox[{
  RowBox[{"spikeCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"Length", "[", 
         RowBox[{"getMutationHistory", "[", 
          RowBox[{"#", ",", "\"\<S\>\""}], "]"}], "]"}]}], "&"}], ",", 
      "nodes"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"39c6e38f-aa36-4a90-8497-7f55ef274065"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s1Counts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"s1Mutations", "[", "#", "]"}]}], "&"}], ",", "nodes"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.948383560161251*^9}, {
  3.9483837289407682`*^9, 3.9483837308235826`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e57d1b94-d2f9-43b6-a895-392385e213a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"s2Counts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"s2Mutations", "[", "#", "]"}]}], "&"}], ",", "nodes"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.94838357424553*^9}, {
  3.9483838247237787`*^9, 3.948383826583047*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"17aaa492-b53e-4f22-8335-ef9648d15fef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ntdCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"ntdMutations", "[", "#", "]"}]}], "&"}], ",", "nodes"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.948383560161251*^9}, {
  3.9483837289407682`*^9, 3.9483837308235826`*^9}, {3.948384514493887*^9, 
  3.948384518790736*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"bd26b3cb-d9d9-480f-bdca-8069ce7e69a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rbdCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"rbdMutations", "[", "#", "]"}]}], "&"}], ",", "nodes"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.948383560161251*^9}, {
  3.9483837289407682`*^9, 3.9483837308235826`*^9}, {3.948384514493887*^9, 
  3.948384527953286*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"b36975b6-9f83-4743-aa61-c0c9fcfeaa5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"orf1abCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"orf1abMutations", "[", "#", "]"}]}], "&"}], ",", "nodes"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.94838357424553*^9}, {
  3.948383803459085*^9, 3.948383821030607*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"1a58ee1a-4b96-4118-8212-53e9b6e23627"],

Cell[BoxData[
 RowBox[{
  RowBox[{"accessoryCounts", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"accessoryMutations", "[", "#", "]"}]}], "&"}], ",", 
      "nodes"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821052452292672*^9, 3.8210525239235373`*^9}, {
  3.821052556977955*^9, 3.821052567122756*^9}, {3.821098518392068*^9, 
  3.821098574263534*^9}, {3.8210987112283382`*^9, 3.821098717465598*^9}, {
  3.821098895904104*^9, 3.821098898830371*^9}, {3.821297539099077*^9, 
  3.8212975788339787`*^9}, {3.8213085854305162`*^9, 3.821308587454376*^9}, {
  3.9397498584167957`*^9, 3.939749861549602*^9}, {3.9483831533722687`*^9, 
  3.9483831802818213`*^9}, {3.9483835469235687`*^9, 3.94838357424553*^9}, {
  3.948383803459085*^9, 3.948383821030607*^9}, {3.9483841497693977`*^9, 
  3.94838415783844*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"3ace27bd-1c72-4032-873c-9419442bf370"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counts", "Section",
 CellChangeTimes->{{3.9365529219199457`*^9, 3.936552924126519*^9}, {
   3.939672177696623*^9, 3.9396721784483843`*^9}, {3.939752207565317*^9, 
   3.9397522081726217`*^9}, 
   3.948384312714093*^9},ExpressionUUID->"ea27847c-06b7-4d3c-93d0-\
2b8aec2d7bee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineagesList", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Values", "[", "lineages", "]"}], "]"}], ",", 
     RowBox[{"Missing", "[", 
      RowBox[{"\"\<KeyAbsent\>\"", ",", "\"\<Nextclade_pango\>\""}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.936553013957911*^9, 3.936553053771031*^9}, {
   3.936553482713159*^9, 3.936553495232421*^9}, {3.939672181300865*^9, 
   3.939672188987116*^9}, {3.9396723605451307`*^9, 3.9396723669402103`*^9}, 
   3.9397497835630608`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"b8190770-a9c0-4b4e-b0c3-cdeda0989723"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"spikeCounts", ",", 
   RowBox[{"Cases", "[", 
    RowBox[{"tips", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{"lineages", "[", "x", "]"}], "==", "\"\<JN.1\>\""}]}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9365534064694443`*^9, 3.936553410006909*^9}, {
  3.939672211875135*^9, 3.9396722187055683`*^9}, {3.9397499361045513`*^9, 
  3.939749950708343*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"e83d5c8d-6a68-4002-a83a-c244e38b8332"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60", ",", "60", ",", "60", ",", "60", ",", "60"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.936553410368861*^9, 3.936553496814405*^9, 3.936554072267991*^9, 
   3.939668492103393*^9, 3.939668942823514*^9, 3.9396720557169724`*^9, 
   3.939672173538597*^9, 3.9396722191643744`*^9, 3.939672373334146*^9, 
   3.9396724290038767`*^9, 3.9397497872397957`*^9, {3.9397499179735928`*^9, 
   3.939749961557678*^9}, 3.939752183619719*^9, 3.939752323082403*^9, 
   3.9397525170057583`*^9, 3.94821460792213*^9, 3.9483830326841307`*^9, 
   3.9483843312671833`*^9, 3.9483849358459044`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"c59de001-9e48-4972-95de-89bb31795275"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"medianSpikeMutationsForLineage", "[", "lineage_", "]"}], ":=", 
  RowBox[{"Median", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"spikeCounts", ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"tips", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"lineages", "[", "x", "]"}], "==", "lineage"}]}]}], "]"}]}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9365532338203087`*^9, 3.9365532605364122`*^9}, {
  3.939672233166215*^9, 3.939672244205472*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"49d3eafb-b9a5-420f-acbd-b22d79339648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"medianCountsForLineage", "[", 
   RowBox[{"lineage_", ",", "countsFunction_"}], "]"}], ":=", 
  RowBox[{"Median", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"countsFunction", ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"tips", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"lineages", "[", "x", "]"}], "==", "lineage"}]}]}], "]"}]}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9365532338203087`*^9, 3.9365532605364122`*^9}, {
  3.939672233166215*^9, 3.939672244205472*^9}, {3.948384334951332*^9, 
  3.948384352453101*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"03aa653a-69fd-4f7a-8aac-09e3e0cd7d84"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"medianCountsForLineage", "[", 
  RowBox[{"\"\<JN.1\>\"", ",", "accessoryCounts"}], "]"}]], "Input",
 CellChangeTimes->{{3.94838435391768*^9, 3.948384362755085*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"82b806ca-c531-41bf-89c8-7b6086562564"],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{3.948384363233584*^9, 3.948384935859242*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"03ac10d2-5b95-40bb-95e6-861f6349bde2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"countsData", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"lineage", ",", "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "nucCounts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "spikeCounts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "s1Counts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "s2Counts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "ntdCounts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "rbdCounts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "orf1abCounts"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"medianCountsForLineage", "[", 
         RowBox[{"lineage", ",", "accessoryCounts"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"lineage", ",", "lineagesList"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.936553274404965*^9, 3.936553334159265*^9}, {
   3.9365540866153517`*^9, 3.936554093334281*^9}, {3.939672262857498*^9, 
   3.939672326402843*^9}, 3.939672529470414*^9, {3.948384387280048*^9, 
   3.948384389370799*^9}, {3.948384580000765*^9, 3.948384669641807*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"d5993519-26d6-4366-aa1c-90e61977dcbc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"countsData", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "5"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.948384612124839*^9, 3.94838461749688*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"afc7110f-b9aa-4464-82bb-a7e696d0148d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"A\"\>", ",", "4.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "1.5`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A.1\"\>", ",", "6.`", ",", "0.`", ",", "0.`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "2.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A.18\"\>", ",", "9.`", ",", "1.`", ",", "1.`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "1.`", ",", "2.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A.19\"\>", ",", "9.`", ",", "1.`", ",", "1.`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "0.`", ",", "2.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"A.2\"\>", ",", "8.`", ",", "0.`", ",", "0.`", ",", "0.`", 
     ",", "0.`", ",", "0.`", ",", "1.`", ",", "3.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9483846178234043`*^9, 3.94838470536619*^9, 
  3.9483849709933434`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"540139bb-9f7d-4bc6-bd67-d2d954880cd7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<lineage\>\"", ",", "\"\<nuc_muts\>\"", ",", "\"\<spike_muts\>\"", 
     ",", "\"\<s1_muts\>\"", ",", "\"\<s2_muts\>\"", ",", "\"\<ntd_muts\>\"", 
     ",", "\"\<rbd_muts\>\"", ",", "\"\<orf1ab_muts\>\"", ",", 
     "\"\<accessory_muts\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948384397163679*^9, 3.948384423108964*^9}, {
  3.9483845339149437`*^9, 3.9483845982048883`*^9}, {3.948384782458275*^9, 
  3.948384784492794*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"24baee0c-4f0a-426c-ab1e-e1da1cd83947"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<results/sarscov2_lineages_mut_counts.tsv\>\"", ",", 
   RowBox[{"Prepend", "[", 
    RowBox[{"countsData", ",", "header"}], "]"}], ",", "\"\<Table\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.936554101965419*^9, 3.9365541515766706`*^9}, {
   3.939672285782311*^9, 3.939672289375978*^9}, {3.939672404741157*^9, 
   3.939672407922164*^9}, {3.9397523021715403`*^9, 3.939752311230727*^9}, 
   3.939752511904039*^9, {3.948384769512389*^9, 3.948384811605603*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"bae0b646-78ef-41df-a549-89ece3248880"],

Cell[BoxData["\<\"results/sarscov2_lineages_mut_counts.tsv\"\>"], "Output",
 CellChangeTimes->{
  3.936554117136073*^9, 3.93655415200465*^9, 3.9396684921912527`*^9, 
   3.939668942904237*^9, 3.939672055805488*^9, 3.939672173633275*^9, 
   3.9396723742611027`*^9, 3.939672429956523*^9, 3.93967253250807*^9, 
   3.939749966069162*^9, 3.9397521880720587`*^9, {3.939752305054515*^9, 
   3.939752331912141*^9}, 3.939752525945045*^9, 3.9482146159210033`*^9, {
   3.948384796566371*^9, 3.948384812085061*^9}, 3.948384971161427*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"375a6c3b-44d8-4553-8cc8-8b9616c5fb48"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430, 839},
WindowMargins->{{24, Automatic}, {Automatic, 21}},
TaggingRules->{"TryRealOnly" -> False},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"04713685-9645-44d9-aa7e-0cb274af2e3b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 577, 8, 123, "Title",ExpressionUUID->"e3be259b-4491-4d3b-94d2-629861f79fba"],
Cell[CellGroupData[{
Cell[1182, 34, 250, 4, 37, "Input",ExpressionUUID->"24a66294-bbbb-4763-a43e-e1bbfe9466d5"],
Cell[1435, 40, 4133, 58, 42, "Output",ExpressionUUID->"788aa169-cfe7-49bd-9a71-c726d2c99830"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5605, 103, 162, 3, 84, "Section",ExpressionUUID->"c8a6c455-e3c5-48c9-8325-02069724bd87"],
Cell[5770, 108, 237, 4, 44, "Text",ExpressionUUID->"8d9e2679-cd27-4b96-a235-c3eea09f34e0"],
Cell[6010, 114, 1470, 32, 220, "Input",ExpressionUUID->"72da1009-5eeb-4312-93ab-f4c6b67579ca"],
Cell[7483, 148, 2003, 51, 142, "Input",ExpressionUUID->"cee78a38-b498-41d6-b13d-8986a53414aa"],
Cell[9489, 201, 976, 25, 116, "Input",ExpressionUUID->"e8aeed6c-3d23-4227-bdc2-56a898cd22cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10502, 231, 260, 4, 84, "Section",ExpressionUUID->"430d1438-3681-4290-a52b-b5db8a397f8a"],
Cell[CellGroupData[{
Cell[10787, 239, 253, 4, 67, "Subsection",ExpressionUUID->"5542d0f3-2531-4f00-847a-b662cc1edfc8"],
Cell[11043, 245, 676, 13, 37, "Input",ExpressionUUID->"690daa4c-9c72-4252-b9a6-8b1b411d6ab6"],
Cell[11722, 260, 341, 9, 37, "Input",ExpressionUUID->"2c345237-8cd6-472a-8859-f0d77d66ed27"],
Cell[12066, 271, 734, 20, 37, "Input",ExpressionUUID->"cf806e03-aee1-4827-981c-401d81d13ccc"],
Cell[CellGroupData[{
Cell[12825, 295, 683, 20, 37, "Input",ExpressionUUID->"83813a79-3c9d-4a2e-ae9f-466b088b3f71"],
Cell[13511, 317, 3338, 46, 42, "Output",ExpressionUUID->"aeac0861-94d7-48d1-aaec-83b01c8cea77"]
}, Open  ]],
Cell[16864, 366, 554, 13, 37, "Input",ExpressionUUID->"ef613151-d991-48ad-8db2-e09a51835309"],
Cell[17421, 381, 531, 13, 37, "Input",ExpressionUUID->"eb305b5e-1463-4ad0-8747-e6109a484ec3"],
Cell[17955, 396, 581, 14, 37, "Input",ExpressionUUID->"44e2ae40-3174-4fd0-9093-1f106957c3ef"],
Cell[18539, 412, 613, 14, 37, "Input",ExpressionUUID->"939467e5-fc88-4cce-9be8-e9a061fa0a41"],
Cell[19155, 428, 569, 14, 37, "Input",ExpressionUUID->"002b0022-3fb6-4aac-8005-cd241a60f925"],
Cell[CellGroupData[{
Cell[19749, 446, 209, 3, 37, "Input",ExpressionUUID->"87d96043-b604-4f24-9a33-279a394cef6b"],
Cell[19961, 451, 3317, 47, 42, "Output",ExpressionUUID->"c878a663-90de-4b67-b94a-51754c955305"]
}, Open  ]],
Cell[23293, 501, 164, 3, 44, "Text",ExpressionUUID->"f83784bb-988c-49cc-9343-a86aa0ec3091"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23494, 509, 165, 3, 67, "Subsection",ExpressionUUID->"006e2e57-9751-4cf7-ae70-e141167411ae"],
Cell[CellGroupData[{
Cell[23684, 516, 358, 8, 37, "Input",ExpressionUUID->"d9381fe8-4fe2-4820-afed-b6af19a68c1c"],
Cell[24045, 526, 3060, 45, 69, "Output",ExpressionUUID->"3bc78d44-0b02-4b00-824e-1539f86a5c5d"]
}, Open  ]],
Cell[27120, 574, 1283, 31, 116, "Input",ExpressionUUID->"122d14be-9120-4806-96dd-559c5a8aebe4"],
Cell[28406, 607, 1285, 31, 116, "Input",ExpressionUUID->"aa24bef5-a421-4ca9-b63e-61e52e3970e8"],
Cell[29694, 640, 1332, 32, 116, "Input",ExpressionUUID->"5c92cd28-5412-48e4-837d-e71195fb93b9"],
Cell[31029, 674, 1334, 32, 116, "Input",ExpressionUUID->"dc11c297-ac6f-4c0b-9cc7-bd419f4fedb7"],
Cell[32366, 708, 934, 23, 142, "Input",ExpressionUUID->"9b5283f7-d05d-469d-9930-dcd60d4cb4ae"],
Cell[33303, 733, 2398, 58, 298, "Input",ExpressionUUID->"8b39f722-4956-4dc7-9356-c4d38ea891fa"],
Cell[35704, 793, 912, 19, 37, "Input",ExpressionUUID->"7e52026c-9fa6-4444-97a7-2b3074a81099"],
Cell[36619, 814, 916, 19, 37, "Input",ExpressionUUID->"39c6e38f-aa36-4a90-8497-7f55ef274065"],
Cell[37538, 835, 927, 18, 37, "Input",ExpressionUUID->"e57d1b94-d2f9-43b6-a895-392385e213a2"],
Cell[38468, 855, 924, 18, 37, "Input",ExpressionUUID->"17aaa492-b53e-4f22-8335-ef9648d15fef"],
Cell[39395, 875, 978, 19, 37, "Input",ExpressionUUID->"bd26b3cb-d9d9-480f-bdca-8069ce7e69a6"],
Cell[40376, 896, 978, 19, 37, "Input",ExpressionUUID->"b36975b6-9f83-4743-aa61-c0c9fcfeaa5c"],
Cell[41357, 917, 930, 18, 37, "Input",ExpressionUUID->"1a58ee1a-4b96-4118-8212-53e9b6e23627"],
Cell[42290, 937, 987, 19, 37, "Input",ExpressionUUID->"3ace27bd-1c72-4032-873c-9419442bf370"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43326, 962, 280, 5, 84, "Section",ExpressionUUID->"ea27847c-06b7-4d3c-93d0-2b8aec2d7bee"],
Cell[43609, 969, 651, 14, 37, "Input",ExpressionUUID->"b8190770-a9c0-4b4e-b0c3-cdeda0989723"],
Cell[CellGroupData[{
Cell[44285, 987, 511, 12, 37, "Input",ExpressionUUID->"e83d5c8d-6a68-4002-a83a-c244e38b8332"],
Cell[44799, 1001, 695, 12, 42, "Output",ExpressionUUID->"c59de001-9e48-4972-95de-89bb31795275"]
}, Open  ]],
Cell[45509, 1016, 589, 14, 37, "Input",ExpressionUUID->"49d3eafb-b9a5-420f-acbd-b22d79339648"],
Cell[46101, 1032, 671, 16, 37, "Input",ExpressionUUID->"03aa653a-69fd-4f7a-8aac-09e3e0cd7d84"],
Cell[CellGroupData[{
Cell[46797, 1052, 267, 4, 37, "Input",ExpressionUUID->"82b806ca-c531-41bf-89c8-7b6086562564"],
Cell[47067, 1058, 172, 2, 42, "Output",ExpressionUUID->"03ac10d2-5b95-40bb-95e6-861f6349bde2"]
}, Open  ]],
Cell[47254, 1063, 2059, 46, 298, "Input",ExpressionUUID->"d5993519-26d6-4366-aa1c-90e61977dcbc"],
Cell[CellGroupData[{
Cell[49338, 1113, 255, 5, 37, "Input",ExpressionUUID->"afc7110f-b9aa-4464-82bb-a7e696d0148d"],
Cell[49596, 1120, 1033, 21, 69, "Output",ExpressionUUID->"540139bb-9f7d-4bc6-bd67-d2d954880cd7"]
}, Open  ]],
Cell[50644, 1144, 604, 12, 37, "Input",ExpressionUUID->"24baee0c-4f0a-426c-ab1e-e1da1cd83947"],
Cell[CellGroupData[{
Cell[51273, 1160, 595, 10, 37, "Input",ExpressionUUID->"bae0b646-78ef-41df-a549-89ece3248880"],
Cell[51871, 1172, 603, 8, 87, "Output",ExpressionUUID->"375a6c3b-44d8-4553-8cc8-8b9616c5fb48"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

