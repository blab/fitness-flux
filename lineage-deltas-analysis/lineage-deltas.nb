(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    154371,       3405]
NotebookOptionsPosition[    140362,       3190]
NotebookOutlinePosition[    140836,       3208]
CellTagsIndexPosition[    140793,       3205]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Analysis of fitness dynamics \[LongDash] lineage deltas", "Title",
 CellChangeTimes->{{3.936542996602244*^9, 3.9365430005467033`*^9}, {
  3.939746771408659*^9, 
  3.939746779731312*^9}},ExpressionUUID->"1813b3bd-5646-490e-8aa0-\
508f91cba565"],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.9368288929350443`*^9, 
  3.9368288934930677`*^9}},ExpressionUUID->"80101095-f50c-437c-ba5a-\
84916a951ca7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"virus", "=", "\"\<sarscov2\>\""}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQPcXIRPRuyFvH1sBvYLqG81zycyCdEvsITLv9jGgA
0XKrBZpAdMDhgnkg+vDjRWDaZ5fyGhC9rVcXTNftjFVnCn3rGHJoEZhe9Xxi
NIhm75wDpu/VO2eD6N66GWA69PWaEFYg3fVyG5j2yNl1kR1It7G+BtMmfGKM
HEC6wEEFTK96y6oMog1kfMD0DFcZsUYgvcxYDUx3eBlO9o1662hzqgVMn9rc
bBsApJkl9O1B9EGL4+cCgfSnHIVLIHpVLe/lICDdkS4OpvN12bcGA+kDNhZg
Or84yasUSKdcyALTLXlyUSBaYnoZmG5Y1r0dRGftngqmO3Y4nQPRcf8KwXSP
8I3GCiAdlfYGTAMAqjOuOw==
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"cf3e29ae-95d2-4b38-b833-953c967c6703"],

Cell[BoxData[
 RowBox[{
  RowBox[{"classification", "=", "\"\<lineages\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.939658916501088*^9, 3.939658924108934*^9}, 
   3.939659118965122*^9, {3.939664356911763*^9, 3.93966435715525*^9}, {
   3.93966754983101*^9, 3.939667606801889*^9}, {3.939671462085685*^9, 
   3.939671463234273*^9}, {3.939730948570822*^9, 3.939730949319483*^9}, {
   3.939732992053977*^9, 3.939732992981229*^9}, {3.939733031919674*^9, 
   3.939733033124846*^9}, {3.939741301116082*^9, 3.939741302143848*^9}, {
   3.939742014380063*^9, 3.939742015124796*^9}, {3.939746768185585*^9, 
   3.939746769107457*^9}, 3.939746826046873*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"f7ca955f-ff30-47b6-9e04-741479a8280b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9365430013576527`*^9, 3.936543009017434*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"599a5b7f-b57c-4745-bd7f-ca487a6914b4"],

Cell[BoxData["\<\"/Users/trvrb/Documents/src/fitness-flux/lineage-deltas-\
analysis\"\>"], "Output",
 CellChangeTimes->{
  3.936543012456723*^9, 3.936545228479741*^9, 3.9365452677583942`*^9, {
   3.936545332747162*^9, 3.936545395957814*^9}, 3.936545634599763*^9, 
   3.936554290881174*^9, 3.9367267286843033`*^9, 3.9367276371303577`*^9, 
   3.9367949066118526`*^9, 3.936796131455682*^9, 3.93680591319523*^9, 
   3.936808734953827*^9, 3.936808937764873*^9, 3.936809298971917*^9, 
   3.9368101916534443`*^9, 3.936810520635723*^9, 3.9368110201764*^9, 
   3.936812487428368*^9, {3.936812526138734*^9, 3.9368125445000553`*^9}, 
   3.9368127347795153`*^9, 3.9368144535027637`*^9, 3.9368281877719088`*^9, 
   3.936828895417313*^9, 3.936829376272917*^9, 3.936833547629318*^9, 
   3.936834742149336*^9, 3.9368354496726418`*^9, 3.936835562975602*^9, 
   3.9368356326963587`*^9, 3.9368363822860947`*^9, 3.936836508516254*^9, 
   3.9368365439479637`*^9, 3.9368366434966288`*^9, 3.9368373870552607`*^9, 
   3.936837755384802*^9, 3.9368377945108223`*^9, 3.9368830075149918`*^9, {
   3.936883413275758*^9, 3.936883421744917*^9}, 3.9368835556042137`*^9, 
   3.936889514399541*^9, 3.936891199271988*^9, 3.936891671423523*^9, 
   3.9368944762769823`*^9, 3.936894614280403*^9, 3.936894986618231*^9, 
   3.93689504449439*^9, 3.936895262315258*^9, 3.9369678956373997`*^9, 
   3.9371379340990553`*^9, 3.937142691938286*^9, 3.9371429658736897`*^9, 
   3.937143117194599*^9, 3.93714325467467*^9, 3.9371438097606783`*^9, 
   3.939658926297143*^9, 3.939659026703003*^9, 3.9396590899502277`*^9, 
   3.9396596685571613`*^9, 3.939665263902116*^9, {3.939667611577731*^9, 
   3.93966762628354*^9}, 3.939668083498877*^9, 3.939668564090247*^9, 
   3.939668979877479*^9, {3.9396692060673513`*^9, 3.939669224021693*^9}, 
   3.939669657982724*^9, {3.9396714669546337`*^9, 3.939671495736373*^9}, 
   3.939672598604331*^9, 3.9397284664562263`*^9, 3.939730951291478*^9, 
   3.939732995461534*^9, 3.939733035369012*^9, 3.939739479886016*^9, 
   3.939740034318542*^9, 3.9397402442410727`*^9, 3.9397403753130302`*^9, 
   3.9397404275345592`*^9, 3.939740684866681*^9, 3.939740896808775*^9, 
   3.9397411183533697`*^9, 3.939741303332209*^9, 3.939742016086605*^9, 
   3.9397467883055983`*^9, 3.939750116551662*^9, 3.93975117340025*^9, {
   3.939751438476707*^9, 3.939751460780177*^9}, 3.939752354844545*^9, 
   3.939752541819138*^9, 3.9397526060255947`*^9, 3.939752693457906*^9, {
   3.939753084816786*^9, 3.939753125801464*^9}, {3.9397531721403503`*^9, 
   3.939753222831355*^9}, 3.939753252907412*^9, 3.939753284917471*^9, 
   3.940094638039753*^9, 3.940094893696178*^9, 3.9400949955678053`*^9, 
   3.940095062611621*^9, 3.940095739751728*^9, 3.940345615928584*^9, {
   3.940345670090391*^9, 3.940345799951833*^9}, 3.940345855186574*^9, 
   3.9403458887951*^9, {3.94034593549654*^9, 3.940345952632167*^9}, 
   3.940348420961165*^9, 3.940348462395162*^9, {3.9403500764191513`*^9, 
   3.9403501188945208`*^9}, 3.948215470631256*^9, 3.948216454537546*^9, 
   3.9482208509144163`*^9, 3.948220896801779*^9, 3.948221077074222*^9, 
   3.9482211307080393`*^9, 3.948373794641108*^9, 3.948374132410816*^9, 
   3.948374339155257*^9, 3.948374423286805*^9, 3.948374512884502*^9, 
   3.948374711525319*^9, 3.948385782153908*^9, 3.9483867566440697`*^9, 
   3.948391255880439*^9, 3.9483915810590963`*^9, {3.948461158724106*^9, 
   3.948461162028097*^9}, 3.9484645604897327`*^9, 3.9484875946203623`*^9, 
   3.9484877030057907`*^9, 3.948490600315014*^9, 3.9484922427473907`*^9, 
   3.9484929115362577`*^9, 3.94855039289143*^9, 3.9485504751484013`*^9, 
   3.9485517171654863`*^9, 3.948552153673304*^9, 3.948552352888082*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"0fa57823-a336-4012-be69-c5c3057a93f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"availableDatasets", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Last", "[", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"#", ",", "\"\</\>\""}], "]"}], "]"}], "&"}], ",", 
    RowBox[{"FileNames", "[", 
     RowBox[{"All", ",", "\"\<../mlr-estimates/\>\""}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.936828213644642*^9, 3.9368283578824463`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"1b14dcae-da8a-4ce4-98e7-4d871df57bbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"backup_sarscov2_lineages_all\"\>", ",", "\<\".DS_Store\"\>", 
   ",", "\<\"h3n2_clades_2016-17\"\>", ",", "\<\"h3n2_clades_2017-18\"\>", 
   ",", "\<\"h3n2_clades_2018-19\"\>", ",", "\<\"h3n2_clades_2019-20\"\>", 
   ",", "\<\"h3n2_clades_2020-21\"\>", ",", "\<\"h3n2_clades_2021-22\"\>", 
   ",", "\<\"h3n2_clades_2022-23\"\>", ",", "\<\"h3n2_clades_2023-24\"\>", 
   ",", "\<\"sarscov2_clades_2020\"\>", 
   ",", "\<\"sarscov2_clades_2020-21\"\>", 
   ",", "\<\"sarscov2_clades_2020-24\"\>", 
   ",", "\<\"sarscov2_clades_2021\"\>", 
   ",", "\<\"sarscov2_clades_2021-22\"\>", 
   ",", "\<\"sarscov2_clades_2022\"\>", 
   ",", "\<\"sarscov2_clades_2022-23\"\>", 
   ",", "\<\"sarscov2_clades_2023\"\>", 
   ",", "\<\"sarscov2_clades_2023-24\"\>", 
   ",", "\<\"sarscov2_clades_2024\"\>", ",", "\<\"sarscov2_lineages_2020\"\>",
    ",", "\<\"sarscov2_lineages_2020-21\"\>", 
   ",", "\<\"sarscov2_lineages_2021\"\>", 
   ",", "\<\"sarscov2_lineages_2021-22\"\>", 
   ",", "\<\"sarscov2_lineages_2022\"\>", 
   ",", "\<\"sarscov2_lineages_2022-23\"\>", 
   ",", "\<\"sarscov2_lineages_2023\"\>", 
   ",", "\<\"sarscov2_lineages_2023-24\"\>", 
   ",", "\<\"sarscov2_lineages_2024\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.936828358344758*^9, {3.9368284245311604`*^9, 3.9368284406963673`*^9}, 
   3.9368288954587517`*^9, 3.936829376319338*^9, 3.936833547700513*^9, 
   3.936834742192738*^9, 3.936835449720607*^9, 3.9368355630202513`*^9, 
   3.936835632734507*^9, 3.936836382321159*^9, 3.9368365085583467`*^9, 
   3.936836543969923*^9, 3.9368366435340357`*^9, 3.936837387083261*^9, 
   3.936837755433333*^9, 3.936837794586504*^9, 3.936883007567788*^9, {
   3.936883413354765*^9, 3.936883421808971*^9}, 3.936883555642674*^9, 
   3.936889514481516*^9, 3.936891199332198*^9, 3.936891671483268*^9, 
   3.936894476354879*^9, 3.936894614300674*^9, 3.936894986635255*^9, 
   3.936895044512784*^9, 3.9368952623374453`*^9, 3.936967895656517*^9, 
   3.937137934125578*^9, 3.937142691971774*^9, 3.937142965935238*^9, 
   3.937143117226057*^9, 3.9371432547085743`*^9, 3.937143809781062*^9, 
   3.939658930067644*^9, 3.939659028696316*^9, 3.9396590917276993`*^9, 
   3.9396596685765657`*^9, 3.939665263981401*^9, {3.939667611622991*^9, 
   3.939667626348984*^9}, 3.9396680835523987`*^9, 3.9396685641173153`*^9, 
   3.939668979903585*^9, {3.939669206085909*^9, 3.939669224031473*^9}, 
   3.939669658005587*^9, {3.939671466972809*^9, 3.939671495756515*^9}, 
   3.9396725986146593`*^9, 3.939728466478814*^9, 3.939730951311305*^9, 
   3.939732995497982*^9, 3.939733035390291*^9, 3.939739479905199*^9, 
   3.9397400343260813`*^9, 3.9397402442775497`*^9, 3.939740375333774*^9, 
   3.939740427565147*^9, 3.9397406848993397`*^9, 3.939740896834087*^9, 
   3.939741118381606*^9, 3.939741303356408*^9, 3.939742016112114*^9, 
   3.939834025516881*^9, 3.9398343992946253`*^9, 3.9398425255911694`*^9, 
   3.939843308906336*^9, 3.939843511023679*^9, 3.9399097472893953`*^9, 
   3.939911475499803*^9, 3.9399124027462997`*^9, 3.939914884589924*^9, 
   3.9399150658326683`*^9, 3.939915767327539*^9, 3.939916520488744*^9, 
   3.939917197676187*^9, 3.939927370014777*^9, 3.939928047818307*^9, 
   3.939928311320187*^9, 3.939928536920354*^9, 3.939930665527776*^9, 
   3.9399307433736067`*^9, 3.940360932473535*^9, 3.940360997580497*^9, 
   3.9403616913025846`*^9, 3.9403620061278257`*^9, 3.940363432416737*^9, 
   3.940363785879324*^9, 3.940364199915557*^9, 3.94768359840343*^9, 
   3.947697415348867*^9, 3.947697868727272*^9, 3.9477065760523653`*^9, 
   3.947783163899336*^9, 3.947784787019927*^9, 3.948392367438149*^9, 
   3.948453819910551*^9, 3.948455549757213*^9, {3.948487703020503*^9, 
   3.9484877305191107`*^9}, 3.948490600318822*^9, 3.948492242780357*^9, 
   3.94849291154039*^9, 3.948550392914859*^9, 3.948550475152131*^9, 
   3.948551717168757*^9, 3.948552153678013*^9, 3.948552352894252*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"a4fa241a-e5a4-4da7-b729-401258ccf0cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"timepoints", "=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "&"}], ",", 
       "availableDatasets"}], "]"}], ",", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", "virus"}], "&&", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "classification"}]}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "3"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.936796198735402*^9, 3.936796230272019*^9}, {
   3.936828201029409*^9, 3.936828208143313*^9}, {3.9368283670140057`*^9, 
   3.936828415312935*^9}, 3.939659046639495*^9, {3.939659100420821*^9, 
   3.9396591227508287`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"c3341a69-bca0-4528-ae47-87d5e9d7bb60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"2020\"\>", ",", "\<\"2020-21\"\>", ",", "\<\"2021\"\>", 
   ",", "\<\"2021-22\"\>", ",", "\<\"2022\"\>", ",", "\<\"2022-23\"\>", 
   ",", "\<\"2023\"\>", ",", "\<\"2023-24\"\>", ",", "\<\"2024\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.936828384061871*^9, 3.936828441325329*^9}, 
   3.936828895461609*^9, 3.936829376322311*^9, 3.9368335477121887`*^9, {
   3.936834735222919*^9, 3.936834742195897*^9}, 3.9368354497237883`*^9, 
   3.9368355630242853`*^9, 3.936835632749007*^9, 3.936836382333836*^9, 
   3.936836508561513*^9, 3.9368365439831448`*^9, 3.936836643547091*^9, 
   3.936837387099571*^9, 3.936837755437113*^9, 3.9368377945890713`*^9, 
   3.9368830075711927`*^9, {3.9368834133599567`*^9, 3.936883421811513*^9}, 
   3.9368835556453133`*^9, 3.936889514495213*^9, 3.936891199334934*^9, 
   3.936891671497211*^9, 3.936894476370525*^9, 3.936894614314295*^9, 
   3.9368949866487837`*^9, 3.9368950445150967`*^9, 3.93689526233974*^9, 
   3.9369678956589518`*^9, 3.937137934140629*^9, 3.937142691977556*^9, 
   3.937142965953524*^9, 3.9371431172434263`*^9, 3.9371432547259617`*^9, 
   3.937143809783566*^9, 3.93965903109613*^9, {3.939659100941691*^9, 
   3.939659123481214*^9}, 3.939659668580131*^9, 3.939665263999523*^9, {
   3.939667611629902*^9, 3.93966762635219*^9}, 3.9396680835564203`*^9, 
   3.939668564120493*^9, 3.9396689799069757`*^9, {3.939669206089328*^9, 
   3.939669224044236*^9}, 3.9396696580087214`*^9, {3.939671466985037*^9, 
   3.939671495769017*^9}, 3.939672598626483*^9, 3.939728466490046*^9, 
   3.939730951321726*^9, 3.93973299550247*^9, 3.939733035393569*^9, 
   3.939739479915813*^9, 3.9397400343290243`*^9, 3.9397402442840548`*^9, 
   3.939740375337181*^9, 3.939740427569502*^9, 3.939740684915344*^9, 
   3.939740896847268*^9, 3.939741118385359*^9, 3.939741303360347*^9, 
   3.939742016114996*^9, 3.939834025537692*^9, 3.939834399298193*^9, 
   3.93984252559667*^9, 3.939843308932727*^9, 3.939843511048066*^9, 
   3.9399097473064747`*^9, 3.939911475505611*^9, 3.939912402763115*^9, 
   3.939914884604734*^9, 3.939915065837914*^9, 3.9399157673419333`*^9, 
   3.939916520491828*^9, 3.939917197678803*^9, 3.939927370032486*^9, 
   3.9399280478214293`*^9, 3.9399283113391*^9, 3.939928536922977*^9, 
   3.939930665530572*^9, 3.9399307433800297`*^9, 3.940360932479228*^9, 
   3.940360997592928*^9, 3.9403616913055153`*^9, 3.940362006141217*^9, 
   3.94036343242017*^9, 3.9403637858826103`*^9, 3.94036419991844*^9, 
   3.947683598422261*^9, 3.947697415367138*^9, 3.94769786873007*^9, 
   3.947706576071969*^9, 3.94778316391875*^9, 3.947784787038012*^9, 
   3.94839236744165*^9, 3.9484538199215107`*^9, 3.948455549767391*^9, {
   3.9484877030242357`*^9, 3.94848773292959*^9}, 3.948489773255319*^9, 
   3.948490600324565*^9, 3.94849224278537*^9, 3.948492911543429*^9, 
   3.948550392923697*^9, 3.9485504751555433`*^9, 3.948551717174633*^9, 
   3.948552153683079*^9, 3.948552352904791*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"6494f930-7e26-44c2-aa1c-da6f7da48fc2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.788472909208424*^9, 3.788472909856656*^9}, {
   3.9368351132261963`*^9, 3.936835115063137*^9}, 
   3.936836729515337*^9},ExpressionUUID->"5cde0a61-02fb-4116-a9cf-\
f8b916b5c311"],

Cell[CellGroupData[{

Cell["Colors", "Subsection",
 CellChangeTimes->{{3.936836731304522*^9, 
  3.936836732083047*^9}},ExpressionUUID->"649d32dd-4b8c-4dfc-886b-\
8d55243627d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"start", "[", "n_", "]"}], ":=", "0.07"}], ";"}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
   3.640983220093966*^9, 3.6409832683836927`*^9}, {3.640984474411666*^9, 
   3.640984479281557*^9}, {3.640984557889563*^9, 3.6409845613384*^9}, {
   3.6598094669614677`*^9, 3.659809472089323*^9}, {3.659809505762617*^9, 
   3.659809530833227*^9}, {3.662512018382986*^9, 3.662512032239871*^9}, {
   3.662512094391695*^9, 3.662512094497735*^9}, {3.695006937516231*^9, 
   3.695006966036841*^9}, {3.695007564666883*^9, 3.695007564779797*^9}, {
   3.695007740976029*^9, 3.6950077500251827`*^9}, 3.695008326317293*^9, 
   3.6950090239616327`*^9, {3.6950090557299232`*^9, 3.695009084344879*^9}, {
   3.6950091588927937`*^9, 3.695009185900956*^9}, {3.695009445879795*^9, 
   3.695009490700204*^9}, {3.695009543441188*^9, 3.69500954354657*^9}, {
   3.8001257483980513`*^9, 3.800125773718319*^9}, {3.8001258562805634`*^9, 
   3.800125856502709*^9}, {3.800126528614277*^9, 3.8001265288033657`*^9}, {
   3.800127173695372*^9, 3.800127177725648*^9}, {3.859040125621222*^9, 
   3.859040135562933*^9}, {3.859040171037079*^9, 3.859040171110623*^9}, {
   3.860941173369759*^9, 3.860941173903747*^9}, 3.8610217917361603`*^9, {
   3.873112956403431*^9, 3.873112957158308*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"82d30892-f492-49bc-83d8-dbf01bf8d67c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stop", "[", "n_", "]"}], ":=", "0.99"}], ";"}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
   3.640983220093966*^9, 3.640983291574483*^9}, {3.640984485938671*^9, 
   3.6409844877616777`*^9}, {3.640984589585147*^9, 3.640984592456441*^9}, {
   3.640984729304956*^9, 3.640984733058432*^9}, {3.659809554856059*^9, 
   3.659809653127249*^9}, {3.6950071264708443`*^9, 3.6950071378917923`*^9}, {
   3.695007765863736*^9, 3.695007812336133*^9}, {3.695009086061452*^9, 
   3.695009086328677*^9}, {3.695009131255892*^9, 3.695009131616884*^9}, {
   3.695009203675231*^9, 3.695009275001924*^9}, 3.6950093444538727`*^9, {
   3.695009405325219*^9, 3.6950094256587257`*^9}, {3.695009478201787*^9, 
   3.695009492172222*^9}, {3.695009547960047*^9, 3.69500959540959*^9}, {
   3.800125801348049*^9, 3.800125851262124*^9}, {3.800126530725336*^9, 
   3.800126530827695*^9}, {3.800127175743314*^9, 3.80012718185425*^9}, {
   3.8590401072082777`*^9, 3.859040131225638*^9}, {3.8590401848525267`*^9, 
   3.8590401851547813`*^9}, {3.873112959976313*^9, 3.87311296031723*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"45349718-3cfd-4feb-92d9-e2c33ee46fc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gap", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"stop", "[", "n", "]"}], "-", 
     RowBox[{"start", "[", "n", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
  3.640983961536694*^9, 3.640983973456325*^9}, {3.640984271099929*^9, 
  3.640984314699469*^9}, {3.6409843562542353`*^9, 3.640984384781535*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d98f3c55-d356-45ad-aaf4-e85fb33c1432"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeColors", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "i", "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"start", "[", "n", "]"}], ",", 
       RowBox[{"stop", "[", "n", "]"}], ",", 
       RowBox[{"gap", "[", "n", "]"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6409833132889223`*^9, 3.6409833219668903`*^9}, {
  3.640983494496229*^9, 3.640983502001274*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"75f78d58-769a-478e-82a5-a56db2e2eae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"startGrays", "[", "n_", "]"}], ":=", "0.35"}], ";"}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
   3.640983220093966*^9, 3.6409832683836927`*^9}, {3.640984474411666*^9, 
   3.640984479281557*^9}, {3.640984557889563*^9, 3.6409845613384*^9}, {
   3.6598094669614677`*^9, 3.659809472089323*^9}, {3.659809505762617*^9, 
   3.659809530833227*^9}, {3.662512018382986*^9, 3.662512032239871*^9}, {
   3.662512094391695*^9, 3.662512094497735*^9}, {3.695006937516231*^9, 
   3.695006966036841*^9}, {3.695007564666883*^9, 3.695007564779797*^9}, {
   3.695007740976029*^9, 3.6950077500251827`*^9}, 3.695008326317293*^9, 
   3.6950090239616327`*^9, {3.6950090557299232`*^9, 3.695009084344879*^9}, {
   3.6950091588927937`*^9, 3.695009185900956*^9}, {3.695009445879795*^9, 
   3.695009490700204*^9}, {3.695009543441188*^9, 3.69500954354657*^9}, {
   3.8001257483980513`*^9, 3.800125773718319*^9}, {3.8001258562805634`*^9, 
   3.800125856502709*^9}, {3.800126528614277*^9, 3.8001265288033657`*^9}, {
   3.800127173695372*^9, 3.800127177725648*^9}, {3.859040125621222*^9, 
   3.859040135562933*^9}, {3.859040171037079*^9, 3.859040171110623*^9}, {
   3.860941173369759*^9, 3.860941173903747*^9}, 3.8610217917361603`*^9, {
   3.873112956403431*^9, 3.873112957158308*^9}, {3.873639924109086*^9, 
   3.873639924256563*^9}, {3.873640238570588*^9, 3.873640265428384*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"95eaf88e-712a-45e9-b401-8cb94cee40b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stopGrays", "[", "n_", "]"}], ":=", "0.65"}], ";"}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
   3.640983220093966*^9, 3.640983291574483*^9}, {3.640984485938671*^9, 
   3.6409844877616777`*^9}, {3.640984589585147*^9, 3.640984592456441*^9}, {
   3.640984729304956*^9, 3.640984733058432*^9}, {3.659809554856059*^9, 
   3.659809653127249*^9}, {3.6950071264708443`*^9, 3.6950071378917923`*^9}, {
   3.695007765863736*^9, 3.695007812336133*^9}, {3.695009086061452*^9, 
   3.695009086328677*^9}, {3.695009131255892*^9, 3.695009131616884*^9}, {
   3.695009203675231*^9, 3.695009275001924*^9}, 3.6950093444538727`*^9, {
   3.695009405325219*^9, 3.6950094256587257`*^9}, {3.695009478201787*^9, 
   3.695009492172222*^9}, {3.695009547960047*^9, 3.69500959540959*^9}, {
   3.800125801348049*^9, 3.800125851262124*^9}, {3.800126530725336*^9, 
   3.800126530827695*^9}, {3.800127175743314*^9, 3.80012718185425*^9}, {
   3.8590401072082777`*^9, 3.859040131225638*^9}, {3.8590401848525267`*^9, 
   3.8590401851547813`*^9}, {3.873112959976313*^9, 3.87311296031723*^9}, {
   3.873640241066037*^9, 3.873640267257639*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2d026e76-f2cf-4574-b745-5ce4b74960b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gapGrays", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"stopGrays", "[", "n", "]"}], "-", 
     RowBox[{"startGrays", "[", "n", "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6409831283657722`*^9, 3.640983168972301*^9}, {
  3.640983961536694*^9, 3.640983973456325*^9}, {3.640984271099929*^9, 
  3.640984314699469*^9}, {3.6409843562542353`*^9, 3.640984384781535*^9}, {
  3.873640243271029*^9, 3.873640243762265*^9}, {3.873640556979631*^9, 
  3.8736405605114727`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"fde0d3d4-a7ab-40db-8385-ce3b1ed80912"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeGrays", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GrayLevel", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"startGrays", "[", "n", "]"}], ",", 
       RowBox[{"stopGrays", "[", "n", "]"}], ",", 
       RowBox[{"gapGrays", "[", "n", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6409833132889223`*^9, 3.6409833219668903`*^9}, {
  3.640983494496229*^9, 3.640983502001274*^9}, {3.873640203071508*^9, 
  3.873640211892264*^9}, {3.87364024662574*^9, 3.8736402513719473`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7bd4d3b3-3bb6-4122-9983-169709b524f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"col", "=", 
  RowBox[{
   RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0.3", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.940095362811079*^9, 3.9400953714270563`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"4ef3fab6-4387-4767-a04d-374ee07b4ede"],

Cell[BoxData[
 InterpretationBox[
  ButtonBox[
   TooltipBox[
    GraphicsBox[{
      {GrayLevel[0], RectangleBox[{0, 0}]}, 
      {GrayLevel[0], RectangleBox[{1, -1}]}, 
      {RGBColor[0.2979596, 0.5657928, 0.7522386000000001], 
       RectangleBox[{0, -1}, {2, 1}]}},
     AspectRatio->1,
     DefaultBaseStyle->"ColorSwatchGraphics",
     Frame->True,
     FrameStyle->RGBColor[0.19863973333333335`, 0.3771952, 0.5014924000000001],
     FrameTicks->None,
     ImageSize->
      Dynamic[{Automatic, 
        1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
         Magnification])}],
     PlotRangePadding->None],
    StyleBox[
     RowBox[{"RGBColor", "[", 
       RowBox[{"0.2979596`", ",", "0.5657928`", ",", "0.7522386000000001`"}], 
       "]"}], NumberMarks -> False]],
   Appearance->None,
   BaseStyle->{},
   BaselinePosition->Baseline,
   ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
     If[
      Not[
       AbsoluteCurrentValue["Deployed"]], 
      SelectionMove[Typeset`box$, All, Expression]; 
      FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
      FrontEnd`Private`$ColorSelectorInitialColor = 
       RGBColor[0.2979596, 0.5657928, 0.7522386000000001]; 
      FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
      MathLink`CallFrontEnd[
        FrontEnd`AttachCell[Typeset`box$, 
         FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
         Left, Top}, 
         "ClosingActions" -> {
          "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
   DefaultBaseStyle->{},
   Evaluator->Automatic,
   Method->"Preemptive"],
  RGBColor[0.2979596, 0.5657928, 0.7522386000000001],
  Editable->False,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.940095371784276*^9, 3.940095741840746*^9, 3.9403456177288923`*^9, {
   3.940345671916342*^9, 3.940345801327621*^9}, 3.940345857421299*^9, 
   3.94034589016294*^9, {3.940345936888854*^9, 3.940345954072495*^9}, 
   3.9403491093169117`*^9, {3.94035007647477*^9, 3.940350118941412*^9}, 
   3.9482154706855392`*^9, 3.948216454586794*^9, 3.948220850989395*^9, 
   3.948220896873543*^9, 3.94822107712204*^9, 3.948221130760076*^9, 
   3.948373796042383*^9, 3.948374132457361*^9, 3.9483743392120256`*^9, 
   3.948374423316842*^9, 3.948374512915915*^9, 3.948374711560266*^9, 
   3.9483857827547493`*^9, 3.948386758768519*^9, 3.948391255958509*^9, 
   3.948391581115058*^9, 3.948461162082055*^9, 3.948464560519068*^9, 
   3.948487595999587*^9, 3.948487737763855*^9, 3.9484906003944063`*^9, 
   3.9484922428394537`*^9, 3.948492911598596*^9, 3.948550392958622*^9, 
   3.948550475216428*^9, 3.948551717222845*^9, 3.948552153768454*^9, 
   3.948552354833859*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"0014821e-9f81-481c-b0cd-429388538ea1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Subsection",
 CellChangeTimes->{{3.936836726856153*^9, 
  3.936836727289649*^9}},ExpressionUUID->"48e7ced9-6a91-4421-bc3b-\
202d711bd2d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gappedPartition", "[", 
   RowBox[{"list_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{"list", ",", "n", ",", "n", ",", "1", ",", "\"\<\>\""}], 
   "]"}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"0ab072a1-6e4c-4471-9f9d-9724bca0479d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variant fitnesses", "Section",
 CellChangeTimes->{{3.948487744582397*^9, 3.9484877487104692`*^9}, {
  3.948487785784479*^9, 
  3.948487787962802*^9}},ExpressionUUID->"d683a946-b8e9-4a07-9345-\
63c8a99db9b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVariantLogFitnessesForTimepoint", "[", "timepoint_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "jsonData", ",", "variants", ",", "elements", ",", "variantToFitness"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"jsonData", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\<../mlr-estimates/\>\"", "<>", "virus", "<>", "\"\<_\>\"", "<>", 
        "classification", "<>", "\"\<_\>\"", "<>", "timepoint", "<>", 
        "\"\</mlr_results.json\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"variants", "=", 
      RowBox[{"\"\<variants\>\"", "/.", 
       RowBox[{"(", 
        RowBox[{"\"\<metadata\>\"", "/.", "jsonData"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"\"\<data\>\"", "/.", "jsonData"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<value\>\"", "/.", "x"}], ")"}], "==", "Null"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"elements", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"elements", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<site\>\"", "/.", "x"}], ")"}], "==", "\"\<ga\>\""}], 
          "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<ps\>\"", "/.", "x"}], ")"}], "==", 
           "\"\<median\>\""}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\"\<location\>\"", "/.", "x"}], ")"}], "==", 
           "\"\<USA\>\""}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"variantToFitness", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"elems", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"elements", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\"\<variant\>\"", "/.", "x"}], ")"}], "==", 
                "variant"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"variant", "->", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "elems", "]"}], ">", "0"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\"\<value\>\"", "/.", "elems"}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"variant", ",", "variants"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"variantToFitness", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"variantToFitness", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<other\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "->", 
         RowBox[{"Log", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
       "variantToFitness"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.936546891628545*^9, 3.93654706718829*^9}, 
   3.9365473486404743`*^9, {3.936547437101098*^9, 3.9365474479790087`*^9}, {
   3.9365476207582817`*^9, 3.936547626696361*^9}, {3.9367270693501577`*^9, 
   3.93672708425742*^9}, {3.93672714041148*^9, 3.936727167050579*^9}, {
   3.936727855131576*^9, 3.9367278641934767`*^9}, {3.936812495436722*^9, 
   3.936812503924893*^9}, {3.939659778257051*^9, 3.939659786683262*^9}, {
   3.9484636061692333`*^9, 3.9484636491603327`*^9}, {3.948487801174736*^9, 
   3.948487801447523*^9}, {3.94848791115289*^9, 3.9484879116782207`*^9}, {
   3.948489317116294*^9, 3.948489321038088*^9}, {3.9484900168899527`*^9, 
   3.948490074547937*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"13cb0ae0-c5f6-4cd3-b9dd-3e3aa6827fdd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"getVariantLogFitnessesForTimepoint", "[", "\"\<2020\>\"", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.948463528392009*^9, 3.948463533534461*^9}, 
   3.948487813155752*^9, 3.948487920319569*^9, 3.9484893289153347`*^9, {
   3.948490000448381*^9, 3.948490003034926*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"e4e01b5b-b05b-49d7-9beb-18be3599f4f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.016452`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"A.1\"\>", "\[Rule]", 
      RowBox[{"-", "0.10425002137379911`"}]}], ",", 
     RowBox[{"\<\"A.3\"\>", "\[Rule]", 
      RowBox[{"-", "0.08012604447928486`"}]}], ",", 
     RowBox[{"\<\"B\"\>", "\[Rule]", 
      RowBox[{"-", "0.040821994520255166`"}]}], ",", 
     RowBox[{"\<\"B.1\"\>", "\[Rule]", "0.04974209189481401`"}], ",", 
     RowBox[{"\<\"B.1.1\"\>", "\[Rule]", "0.07045846364856137`"}], ",", 
     RowBox[{"\<\"B.1.1.291\"\>", "\[Rule]", "0.03922071315328133`"}], ",", 
     RowBox[{"\<\"B.1.1.434\"\>", "\[Rule]", "0.13714983814723367`"}], ",", 
     RowBox[{"\<\"B.1.110.3\"\>", "\[Rule]", "0.0769610411361284`"}], ",", 
     RowBox[{"\<\"B.1.2\"\>", "\[Rule]", "0.11689375147149943`"}], ",", 
     RowBox[{"\<\"B.1.206\"\>", "\[Rule]", "0.044973365642731196`"}], ",", 
     RowBox[{"\<\"B.1.232\"\>", "\[Rule]", "0.14323416808590775`"}], ",", 
     RowBox[{"\<\"B.1.234\"\>", "\[Rule]", "0.1275133202989595`"}], ",", 
     RowBox[{"\<\"B.1.240\"\>", "\[Rule]", "0.08157998699242285`"}], ",", 
     RowBox[{"\<\"B.1.243\"\>", "\[Rule]", "0.10165365372649982`"}], ",", 
     RowBox[{"\<\"B.1.311\"\>", "\[Rule]", "0.13976194237515863`"}], ",", 
     RowBox[{"\<\"B.1.320\"\>", "\[Rule]", "0.`"}], ",", 
     RowBox[{"\<\"B.1.371\"\>", "\[Rule]", 
      RowBox[{"-", "0.027371196796132015`"}]}], ",", 
     RowBox[{"\<\"B.1.396\"\>", "\[Rule]", "0.0962188577405429`"}], ",", 
     RowBox[{"\<\"B.1.400\"\>", "\[Rule]", "0.10255658832509215`"}], ",", 
     RowBox[{"\<\"B.1.426\"\>", "\[Rule]", "0.04305948946044701`"}], ",", 
     RowBox[{"\<\"B.1.427\"\>", "\[Rule]", "0.25619140536041013`"}], ",", 
     RowBox[{"\<\"B.1.429\"\>", "\[Rule]", "0.24529635595534308`"}], ",", 
     RowBox[{"\<\"B.1.436\"\>", "\[Rule]", "0.11243542932978817`"}], ",", 
     RowBox[{"\<\"B.1.509\"\>", "\[Rule]", "0.07232066157962608`"}], ",", 
     RowBox[{"\<\"B.1.561\"\>", "\[Rule]", "0.1922718876471227`"}], ",", 
     RowBox[{"\<\"B.1.565\"\>", "\[Rule]", "0.0944006754214843`"}], ",", 
     RowBox[{"\<\"B.1.577\"\>", "\[Rule]", "0.10436001532424286`"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.948463537524398*^9, {3.948463625020545*^9, 3.948463652822013*^9}, 
   3.94846459190209*^9, {3.94848779442522*^9, 3.9484878162315474`*^9}, 
   3.9484879233429337`*^9, 3.94848933204414*^9, {3.948490005968059*^9, 
   3.9484900255996857`*^9}, 3.948490077676182*^9, 3.948490119671699*^9, 
   3.948490601033597*^9, 3.948492243461474*^9, 3.948492912179872*^9, 
   3.948550393552662*^9, 3.9485504759652157`*^9, 3.948551717783966*^9, 
   3.94855215445115*^9, 3.948552355536007*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"9ffaa08b-1619-45fc-bf21-4713b076a627"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantFitnessData", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "timepoint", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
         RowBox[{
         "getVariantLogFitnessesForTimepoint", "[", "timepoint", "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"timepoint", ",", "timepoints"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948464134604052*^9, 3.9484642452856703`*^9}, 
   3.948487821189699*^9, 3.948489334415279*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"284914c1-35e0-477c-8102-2c911e571007"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "variantFitnessData", "]"}]], "Input",
 CellChangeTimes->{{3.9484645153246803`*^9, 3.948464520390998*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c754de68-ce8f-4e5e-9366-4af0251169d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"702", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.94846452104252*^9, 3.948464834115364*^9, 
  3.948488008820204*^9, 3.948489410581071*^9, 3.948490135511245*^9, 
  3.948490616905881*^9, 3.948492257845117*^9, 3.9484929263289347`*^9, 
  3.948550490188332*^9, 3.9485517323800592`*^9, 3.948552168536106*^9, 
  3.948552369747699*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"d44d6c92-32e9-4160-8a96-2ddbc8e3c243"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantLogFitnessesForTimepoint", "[", "timepoint_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "->", 
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"variantFitnessData", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "timepoint"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9484893524615192`*^9, 3.948489358332703*^9}, {
  3.948489392532215*^9, 3.9484894025158367`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"0fd5e0ba-0381-4f72-80de-512131ad5b4e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"variantLogFitnessesForTimepoint", "[", "\"\<2021\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.948489413930683*^9, 3.948489416364324*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"50f75f13-d8d8-4824-8cea-3474bef02370"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"A.2.5\"\>", "\[Rule]", 
    RowBox[{"-", "0.24718012914245105`"}]}], ",", 
   RowBox[{"\<\"AY.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.022245608947319737`"}]}], ",", 
   RowBox[{"\<\"AY.100\"\>", "\[Rule]", "0.036331929247390204`"}], ",", 
   RowBox[{"\<\"AY.103\"\>", "\[Rule]", "0.03246719013750141`"}], ",", 
   RowBox[{"\<\"AY.107\"\>", "\[Rule]", "0.023716526617316065`"}], ",", 
   RowBox[{"\<\"AY.110\"\>", "\[Rule]", 
    RowBox[{"-", "0.05129329438755058`"}]}], ",", 
   RowBox[{"\<\"AY.113\"\>", "\[Rule]", "0.03922071315328133`"}], ",", 
   RowBox[{"\<\"AY.114\"\>", "\[Rule]", 
    RowBox[{"-", "0.011060947359424948`"}]}], ",", 
   RowBox[{"\<\"AY.116.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.00904074465214907`"}]}], ",", 
   RowBox[{"\<\"AY.117\"\>", "\[Rule]", "0.035367143837291344`"}], ",", 
   RowBox[{"\<\"AY.118\"\>", "\[Rule]", "0.002995508979798371`"}], ",", 
   RowBox[{"\<\"AY.119\"\>", "\[Rule]", "0.024692612590371414`"}], ",", 
   RowBox[{"\<\"AY.119.2\"\>", "\[Rule]", "0.036331929247390204`"}], ",", 
   RowBox[{"\<\"AY.120.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.006018072325563021`"}]}], ",", 
   RowBox[{"\<\"AY.121\"\>", "\[Rule]", "0.0695260626486103`"}], ",", 
   RowBox[{"\<\"AY.122\"\>", "\[Rule]", "0.009950330853168092`"}], ",", 
   RowBox[{"\<\"AY.125\"\>", "\[Rule]", "0.05638033343610769`"}], ",", 
   RowBox[{"\<\"AY.127\"\>", "\[Rule]", "0.07417939817425147`"}], ",", 
   RowBox[{"\<\"AY.13\"\>", "\[Rule]", 
    RowBox[{"-", "0.06935007813479317`"}]}], ",", 
   RowBox[{"\<\"AY.14\"\>", "\[Rule]", 
    RowBox[{"-", "0.054456185796058855`"}]}], ",", 
   RowBox[{"\<\"AY.2\"\>", "\[Rule]", 
    RowBox[{"-", "0.10536051565782628`"}]}], ",", 
   RowBox[{"\<\"AY.20\"\>", "\[Rule]", "0.007968169649176881`"}], ",", 
   RowBox[{"\<\"AY.20.1\"\>", "\[Rule]", "0.016857117066422806`"}], ",", 
   RowBox[{"\<\"AY.25\"\>", "\[Rule]", "0.013902905168991434`"}], ",", 
   RowBox[{"\<\"AY.25.1\"\>", "\[Rule]", "0.023716526617316065`"}], ",", 
   RowBox[{"\<\"AY.25.1.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.005012541823544286`"}]}], ",", 
   RowBox[{"\<\"AY.26\"\>", "\[Rule]", 
    RowBox[{"-", "0.017146158834970514`"}]}], ",", 
   RowBox[{"\<\"AY.3\"\>", "\[Rule]", "0.01980262729617973`"}], ",", 
   RowBox[{"\<\"AY.3.1\"\>", "\[Rule]", "0.006975613736425138`"}], ",", 
   RowBox[{"\<\"AY.3.3\"\>", "\[Rule]", "0.05921185963184603`"}], ",", 
   RowBox[{"\<\"AY.33\"\>", "\[Rule]", "0.018821754240587667`"}], ",", 
   RowBox[{"\<\"AY.34.1\"\>", "\[Rule]", "0.07603468627599758`"}], ",", 
   RowBox[{"\<\"AY.35\"\>", "\[Rule]", 
    RowBox[{"-", "0.044997365930735805`"}]}], ",", 
   RowBox[{"\<\"AY.36\"\>", "\[Rule]", "0.03246719013750141`"}], ",", 
   RowBox[{"\<\"AY.37\"\>", "\[Rule]", 
    RowBox[{"-", "0.03562717764315116`"}]}], ",", 
   RowBox[{"\<\"AY.39\"\>", "\[Rule]", "0.03343477608623742`"}], ",", 
   RowBox[{"\<\"AY.39.1\"\>", "\[Rule]", "0.028587456851912472`"}], ",", 
   RowBox[{"\<\"AY.4\"\>", "\[Rule]", "0.042101176018635326`"}], ",", 
   RowBox[{"\<\"AY.43\"\>", "\[Rule]", "0.07045846364856137`"}], ",", 
   RowBox[{"\<\"AY.44\"\>", "\[Rule]", "0.010939940038334263`"}], ",", 
   RowBox[{"\<\"AY.46.1\"\>", "\[Rule]", "0.05259245011917063`"}], ",", 
   RowBox[{"\<\"AY.46.4\"\>", "\[Rule]", "0.018821754240587667`"}], ",", 
   RowBox[{"\<\"AY.47\"\>", "\[Rule]", 
    RowBox[{"-", "0.01308523954865548`"}]}], ",", 
   RowBox[{"\<\"AY.48\"\>", "\[Rule]", 
    RowBox[{"-", "0.0779615414697118`"}]}], ",", 
   RowBox[{"\<\"AY.5\"\>", "\[Rule]", 
    RowBox[{"-", "0.00904074465214907`"}]}], ",", 
   RowBox[{"\<\"AY.5.3\"\>", "\[Rule]", "0.010939940038334263`"}], ",", 
   RowBox[{"\<\"AY.52\"\>", "\[Rule]", 
    RowBox[{"-", "0.08992470752798701`"}]}], ",", 
   RowBox[{"\<\"AY.54\"\>", "\[Rule]", 
    RowBox[{"-", "0.03459144476961909`"}]}], ",", 
   RowBox[{"\<\"AY.62\"\>", "\[Rule]", 
    RowBox[{"-", "0.054456185796058855`"}]}], ",", 
   RowBox[{"\<\"AY.64\"\>", "\[Rule]", 
    RowBox[{"-", "0.019182819416773987`"}]}], ",", 
   RowBox[{"\<\"AY.67\"\>", "\[Rule]", 
    RowBox[{"-", "0.07149600170506992`"}]}], ",", 
   RowBox[{"\<\"AY.75\"\>", "\[Rule]", 
    RowBox[{"-", "0.030459207484708574`"}]}], ",", 
   RowBox[{"\<\"AY.9\"\>", "\[Rule]", 
    RowBox[{"-", "0.004008021397538822`"}]}], ",", 
   RowBox[{"\<\"AY.98.1\"\>", "\[Rule]", "0.042101176018635326`"}], ",", 
   RowBox[{"\<\"B\"\>", "\[Rule]", "0.007968169649176881`"}], ",", 
   RowBox[{"\<\"B.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.48288625507674926`"}]}], ",", 
   RowBox[{"\<\"B.1.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.4780358009429998`"}]}], ",", 
   RowBox[{"\<\"B.1.1.318\"\>", "\[Rule]", 
    RowBox[{"-", "0.2783920255446883`"}]}], ",", 
   RowBox[{"\<\"B.1.1.434\"\>", "\[Rule]", 
    RowBox[{"-", "0.5603660693261269`"}]}], ",", 
   RowBox[{"\<\"B.1.1.519\"\>", "\[Rule]", 
    RowBox[{"-", "0.3856624808119846`"}]}], ",", 
   RowBox[{"\<\"B.1.1.7\"\>", "\[Rule]", 
    RowBox[{"-", "0.2890162954649176`"}]}], ",", 
   RowBox[{"\<\"B.1.2\"\>", "\[Rule]", 
    RowBox[{"-", "0.49593701127224005`"}]}], ",", 
   RowBox[{"\<\"B.1.234\"\>", "\[Rule]", 
    RowBox[{"-", "0.5124936808666878`"}]}], ",", 
   RowBox[{"\<\"B.1.243\"\>", "\[Rule]", 
    RowBox[{"-", "0.5175146119167874`"}]}], ",", 
   RowBox[{"\<\"B.1.311\"\>", "\[Rule]", 
    RowBox[{"-", "0.5124936808666878`"}]}], ",", 
   RowBox[{"\<\"B.1.351\"\>", "\[Rule]", 
    RowBox[{"-", "0.31471074483970024`"}]}], ",", 
   RowBox[{"\<\"B.1.400\"\>", "\[Rule]", 
    RowBox[{"-", "0.5816058058270378`"}]}], ",", 
   RowBox[{"\<\"B.1.427\"\>", "\[Rule]", 
    RowBox[{"-", "0.44785082460460224`"}]}], ",", 
   RowBox[{"\<\"B.1.429\"\>", "\[Rule]", 
    RowBox[{"-", "0.44316697529217586`"}]}], ",", 
   RowBox[{"\<\"B.1.517\"\>", "\[Rule]", 
    RowBox[{"-", "0.49265831981054176`"}]}], ",", 
   RowBox[{"\<\"B.1.525\"\>", "\[Rule]", 
    RowBox[{"-", "0.34531118528841737`"}]}], ",", 
   RowBox[{"\<\"B.1.526\"\>", "\[Rule]", 
    RowBox[{"-", "0.32573014008931084`"}]}], ",", 
   RowBox[{"\<\"B.1.561\"\>", "\[Rule]", 
    RowBox[{"-", "0.53785429615391`"}]}], ",", 
   RowBox[{"\<\"B.1.575\"\>", "\[Rule]", 
    RowBox[{"-", "0.4049652330665133`"}]}], ",", 
   RowBox[{"\<\"B.1.617.2\"\>", "\[Rule]", 
    RowBox[{"-", "0.011060947359424948`"}]}], ",", 
   RowBox[{"\<\"B.1.621\"\>", "\[Rule]", 
    RowBox[{"-", "0.1438703704197019`"}]}], ",", 
   RowBox[{"\<\"B.1.621.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.13926206733350766`"}]}], ",", 
   RowBox[{"\<\"B.1.623\"\>", "\[Rule]", 
    RowBox[{"-", "0.36528331847533263`"}]}], ",", 
   RowBox[{"\<\"B.1.637\"\>", "\[Rule]", 
    RowBox[{"-", "0.2997546536860502`"}]}], ",", 
   RowBox[{"\<\"BA.1\"\>", "\[Rule]", "0.6439569363691735`"}], ",", 
   RowBox[{"\<\"BA.1.1\"\>", "\[Rule]", "0.7820733897543468`"}], ",", 
   RowBox[{"\<\"BA.1.1.18\"\>", "\[Rule]", "0.8202202631234213`"}], ",", 
   RowBox[{"\<\"BA.1.1.2\"\>", "\[Rule]", "0.6270073780554004`"}], ",", 
   RowBox[{"\<\"BA.1.15\"\>", "\[Rule]", "0.7481087386339197`"}], ",", 
   RowBox[{"\<\"BA.1.17\"\>", "\[Rule]", "0.5782973388810033`"}], ",", 
   RowBox[{"\<\"BA.1.17.2\"\>", "\[Rule]", "0.6673164205254238`"}], ",", 
   RowBox[{"\<\"BA.1.18\"\>", "\[Rule]", "0.6168059473032227`"}], ",", 
   RowBox[{"\<\"BA.1.20\"\>", "\[Rule]", "0.7579981528795616`"}], ",", 
   RowBox[{"\<\"C.37\"\>", "\[Rule]", 
    RowBox[{"-", "0.21940056503537533`"}]}], ",", 
   RowBox[{"\<\"P.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.23193205734728903`"}]}], ",", 
   RowBox[{"\<\"P.1.10\"\>", "\[Rule]", 
    RowBox[{"-", "0.23445731121448313`"}]}], ",", 
   RowBox[{"\<\"P.1.13\"\>", "\[Rule]", 
    RowBox[{"-", "0.24974423311138874`"}]}], ",", 
   RowBox[{"\<\"P.1.17\"\>", "\[Rule]", 
    RowBox[{"-", "0.2144316107121882`"}]}], ",", 
   RowBox[{"\<\"P.2\"\>", "\[Rule]", 
    RowBox[{"-", "0.4462871026284195`"}]}], ",", 
   RowBox[{"\<\"Q.3\"\>", "\[Rule]", 
    RowBox[{"-", "0.26266430947649305`"}]}], ",", 
   RowBox[{"\<\"R.1\"\>", "\[Rule]", 
    RowBox[{"-", "0.390084006069862`"}]}], ",", 
   RowBox[{"\<\"XB\"\>", "\[Rule]", 
    RowBox[{"-", "0.1839228381609285`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.948489417111141*^9, 3.9484901355479813`*^9, 
  3.948490616910603*^9, 3.948492257872178*^9, 3.948492926341836*^9, 
  3.948550490218474*^9, 3.948551732386676*^9, 3.948552168542088*^9, 
  3.9485523697536793`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"7b603005-c807-43d2-806a-c65f7a4fc8b3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variant relationships", "Section",
 CellChangeTimes->{{3.948487830519363*^9, 
  3.9484878399127817`*^9}},ExpressionUUID->"70fea9cb-924c-494c-bc2c-\
0447ccda8147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToParentForTimepoint", "[", "timepoint_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{
          "\"\<../sequence-counts/\>\"", "<>", "virus", "<>", "\"\<_\>\"", "<>",
            "classification", "<>", "\"\<_\>\"", "<>", "timepoint", "<>", 
           "\"\</variant_relationships.tsv\>\""}], ",", "\"\<Table\>\""}], 
         "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"data", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "x", "]"}], ">", "1"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "->", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948487904129231*^9, 3.948487907299694*^9}, {
  3.9484879508872232`*^9, 3.9484880231252327`*^9}, {3.948488057749261*^9, 
  3.948488075303198*^9}, {3.9484892370896997`*^9, 3.948489282601582*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"12cf08df-1562-4805-ae94-ba41065866cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"variantToParentForTimepoint", "[", "\"\<2021\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.94848808056686*^9, 3.9484880859864273`*^9}, {
  3.948489428967157*^9, 3.9484894292805233`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b27f4e68-7f06-4a25-81b7-1ea8c9319ca8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"AY.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.100\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.103\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.107\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.110\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.113\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.114\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.116.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.117\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.118\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.119\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.119.2\"\>", "\[Rule]", "\<\"AY.119\"\>"}], ",", 
   RowBox[{"\<\"AY.120.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.121\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.122\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.125\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.127\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.13\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.14\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.2\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.20\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.20.1\"\>", "\[Rule]", "\<\"AY.20\"\>"}], ",", 
   RowBox[{"\<\"AY.25\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.25.1\"\>", "\[Rule]", "\<\"AY.25\"\>"}], ",", 
   RowBox[{"\<\"AY.25.1.1\"\>", "\[Rule]", "\<\"AY.25.1\"\>"}], ",", 
   RowBox[{"\<\"AY.26\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.3\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.3.1\"\>", "\[Rule]", "\<\"AY.3\"\>"}], ",", 
   RowBox[{"\<\"AY.3.3\"\>", "\[Rule]", "\<\"AY.3\"\>"}], ",", 
   RowBox[{"\<\"AY.33\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.34.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.35\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.36\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.37\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.39\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.39.1\"\>", "\[Rule]", "\<\"AY.39\"\>"}], ",", 
   RowBox[{"\<\"AY.4\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.43\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.44\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.46.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.46.4\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.47\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.48\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.5\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.5.3\"\>", "\[Rule]", "\<\"AY.5\"\>"}], ",", 
   RowBox[{"\<\"AY.52\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.54\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.62\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.64\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.67\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.75\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.9\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"AY.98.1\"\>", "\[Rule]", "\<\"B.1.617.2\"\>"}], ",", 
   RowBox[{"\<\"B.1\"\>", "\[Rule]", "\<\"B\"\>"}], ",", 
   RowBox[{"\<\"B.1.1\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.1.318\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.1.434\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.1.519\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.1.7\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.2\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.234\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.243\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.311\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.351\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.400\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.427\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.429\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.517\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.525\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.526\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.561\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.575\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.617.2\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.621\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.621.1\"\>", "\[Rule]", "\<\"B.1.621\"\>"}], ",", 
   RowBox[{"\<\"B.1.623\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"B.1.637\"\>", "\[Rule]", "\<\"B.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.1\"\>", "\[Rule]", "\<\"BA.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.1.18\"\>", "\[Rule]", "\<\"BA.1.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.1.2\"\>", "\[Rule]", "\<\"BA.1.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.15\"\>", "\[Rule]", "\<\"BA.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.17\"\>", "\[Rule]", "\<\"BA.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.17.2\"\>", "\[Rule]", "\<\"BA.1.17\"\>"}], ",", 
   RowBox[{"\<\"BA.1.18\"\>", "\[Rule]", "\<\"BA.1\"\>"}], ",", 
   RowBox[{"\<\"BA.1.20\"\>", "\[Rule]", "\<\"BA.1\"\>"}], ",", 
   RowBox[{"\<\"C.37\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"P.1\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"P.1.10\"\>", "\[Rule]", "\<\"P.1\"\>"}], ",", 
   RowBox[{"\<\"P.1.13\"\>", "\[Rule]", "\<\"P.1\"\>"}], ",", 
   RowBox[{"\<\"P.1.17\"\>", "\[Rule]", "\<\"P.1\"\>"}], ",", 
   RowBox[{"\<\"P.2\"\>", "\[Rule]", "\<\"B.1.1\"\>"}], ",", 
   RowBox[{"\<\"Q.3\"\>", "\[Rule]", "\<\"B.1.1.7\"\>"}], ",", 
   RowBox[{"\<\"R.1\"\>", "\[Rule]", "\<\"B.1.1\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9484880867120543`*^9, {3.948489224808886*^9, 3.948489306383357*^9}, 
   3.94848942969637*^9, 3.948490616941023*^9, 3.9484922578835077`*^9, 
   3.948492926356083*^9, 3.94855049025184*^9, 3.948551732406579*^9, 
   3.948552168588822*^9, 3.948552369810217*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"a38bc562-c68b-4164-8d26-5ade8358a7ed"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variant mutation counts", "Section",
 CellChangeTimes->{{3.9397468150739183`*^9, 3.9397468198662577`*^9}, {
  3.939747266096878*^9, 3.9397472690972347`*^9}, {3.9484894426158133`*^9, 
  3.948489454632218*^9}},ExpressionUUID->"bbfe827f-2fa6-490f-a91d-\
9403d107ceec"],

Cell[CellGroupData[{

Cell["Import mutation counts", "Subsection",
 CellChangeTimes->{{3.9397472784992647`*^9, 3.939747281587661*^9}, {
  3.93975236378578*^9, 3.9397523645483217`*^9}, {3.948385810000393*^9, 
  3.948385811740559*^9}},ExpressionUUID->"4c4d7567-d092-474f-ace7-\
62deda3b16a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutCountData", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
    "\"\<source-data/sarscov2_lineages_mut_counts.tsv\>\"", ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9397471874997787`*^9, 3.939747248991481*^9}, {
   3.93974728527912*^9, 3.9397473050400877`*^9}, 3.939751448442778*^9, {
   3.948385814740404*^9, 3.948385823521302*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"68ebe8ee-aa1e-42e7-b357-e299db7e9b1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"header", "=", 
  RowBox[{"mutCountData", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948385825600431*^9, 3.94838582982703*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"a5a1702b-9cc5-4d2d-a561-37882530ab84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"lineage\"\>", ",", "\<\"nuc_muts\"\>", 
   ",", "\<\"spike_muts\"\>", ",", "\<\"s1_muts\"\>", ",", "\<\"s2_muts\"\>", 
   ",", "\<\"ntd_muts\"\>", ",", "\<\"rbd_muts\"\>", 
   ",", "\<\"orf1ab_muts\"\>", ",", "\<\"accessory_muts\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9483858301248817`*^9, 3.948386071137537*^9, 3.948386761238162*^9, 
   3.948391256055462*^9, 3.948391581174535*^9, 3.948461162134976*^9, 
   3.948464560580289*^9, {3.9484875991966677`*^9, 3.948487609918336*^9}, 
   3.9484894577427883`*^9, 3.9484906169671907`*^9, 3.948492257918086*^9, 
   3.948492926402651*^9, 3.948550490287951*^9, 3.948551732434527*^9, 
   3.948552168624043*^9, 3.948552369874522*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"f9b796ac-901f-4655-ab7a-aaf959ff87a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapIndexed", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#1", "->", 
     RowBox[{"#2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "header"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9483858603763447`*^9, 3.948385874822927*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7dbe2c80-22be-4f52-9c05-7471ef8f349b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"lineage\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"nuc_muts\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"spike_muts\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"s1_muts\"\>", "\[Rule]", "4"}], ",", 
   RowBox[{"\<\"s2_muts\"\>", "\[Rule]", "5"}], ",", 
   RowBox[{"\<\"ntd_muts\"\>", "\[Rule]", "6"}], ",", 
   RowBox[{"\<\"rbd_muts\"\>", "\[Rule]", "7"}], ",", 
   RowBox[{"\<\"orf1ab_muts\"\>", "\[Rule]", "8"}], ",", 
   RowBox[{"\<\"accessory_muts\"\>", "\[Rule]", "9"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9483858645384197`*^9, 3.948385875226006*^9}, 
   3.948386071148859*^9, 3.948386761250647*^9, 3.948391256066101*^9, 
   3.948391581185337*^9, 3.948461162144664*^9, 3.9484645605928383`*^9, {
   3.9484875992112617`*^9, 3.948487609933961*^9}, 3.948489458816848*^9, 
   3.9484906169747753`*^9, 3.948492257923064*^9, 3.948492926411518*^9, 
   3.948550490291988*^9, 3.94855173244377*^9, 3.948552168657599*^9, 
   3.948552369927619*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"601ce908-73f9-4ad4-8227-f9da8b4e3450"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutCountData", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"mutCountData", ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948385834476686*^9, 3.94838583752947*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"087c4f2e-a58d-4afd-bbce-e8e916d45d38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToNucCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948385845502598*^9, 3.9483858881577578`*^9}, {
  3.948385929736218*^9, 3.948385942690938*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"24f01284-a8f6-4a6d-9011-5175fc109979"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToSpikeCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385953310178*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"fed23a48-2bcc-48fa-937f-08fe3bd1a053"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToS1Count", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385958576549*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"59551a0c-066a-4dd2-ba74-e65ec2f7b0d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToS2Count", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385963696509*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"10f73b14-1960-4337-b962-36c7b1903226"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToNTDCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385970610736*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"6bcc7632-43f3-457f-8e19-5a1e05c900c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToRBDCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "7", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385977612236*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"c15f36b2-5866-4c3e-9757-22beee090e0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToORF1abCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "8", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385986196813*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"e5fec561-7b08-4dbc-a705-1c206fac3124"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToAccessoryCount", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "9", "]"}], "]"}]}], "&"}], ",", "mutCountData"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483859486444817`*^9, 3.948385995145013*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"0acee9a6-ddb9-45e6-b138-9e79f4900466"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import EvEscape scores", "Subsection",
 CellChangeTimes->{{3.94837663022458*^9, 
  3.948376638082746*^9}},ExpressionUUID->"be6ea4af-1e94-4a3c-b86e-\
2246a7920811"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lines", "=", 
   RowBox[{"StringSplit", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<source-data/COVID19_all.csv\>\"", ",", "\"\<Text\>\""}], 
      "]"}], ",", "\"\<\\n\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.89257878635087*^9, 3.8925787878601837`*^9}, {
   3.8925789697801123`*^9, 3.892578982818489*^9}, {3.89257939205265*^9, 
   3.892579423496286*^9}, 3.892579485005311*^9, {3.892593453313841*^9, 
   3.8925934560990887`*^9}, 3.908318800130584*^9, 3.9483767995211163`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"f689bc49-5a7c-465d-8104-ba15bf8516f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"textData", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringSplit", "[", 
       RowBox[{"#", ",", "\"\<,\>\""}], "]"}], "&"}], ",", "lines"}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.8925794517380743`*^9, 3.892579462752439*^9}, {
  3.948376804541877*^9, 3.9483768064227743`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"ea4acf7c-5794-4589-904d-b4779d573336"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"textData", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.9483768087478027`*^9, 3.948376819086143*^9}, 
   3.948376849262591*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"05251fda-7991-4dcf-9b1b-41260fa2b768"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"accession_id\"\>", ",", "\<\"count\"\>", 
   ",", "\<\"mode_lineage\"\>", ",", "\<\"num_mutations\"\>", 
   ",", "\<\"missense mutations\"\>", ",", "\<\"min_date\"\>", 
   ",", "\<\"evescape\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.94837681100743*^9, 3.9483768195320873`*^9}, 
   3.948376849773704*^9, 3.948386003064275*^9, 3.948386071780135*^9, 
   3.94838676192787*^9, 3.9483912567225723`*^9, 3.948391581820819*^9, 
   3.948461162813024*^9, 3.948464561255776*^9, {3.948487599877913*^9, 
   3.948487610587555*^9}, 3.9484894707885227`*^9, 3.94849061761036*^9, 
   3.948492258649122*^9, 3.948492927044713*^9, 3.948550490947267*^9, 
   3.9485517330818644`*^9, 3.9485521693227386`*^9, 3.9485523706136*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"d9244a57-5bea-4825-8292-07320b7b7dbc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"evescapeData", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
       "textData"}], "]"}], ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.892578767027543*^9, 3.892578790566844*^9}, 
   3.8925788457021112`*^9, {3.892580648992908*^9, 3.892580649703624*^9}, 
   3.8925808059398603`*^9, 3.9083188254176607`*^9, {3.9483768464186907`*^9, 
   3.9483768803594627`*^9}, {3.948376941335065*^9, 3.9483769464713497`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"28b927fc-0648-48b6-b563-0c91ea8ca55b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToEvEscape", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "->", 
       RowBox[{"Mean", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "&"}], ",", 
     RowBox[{"Gather", "[", 
      RowBox[{"evescapeData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "==", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948377060906255*^9, 3.948377210212605*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"dd988052-679c-40d9-afd1-93ad1fa873f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import ESM log likelihoods (perplexities)", "Subsection",
 CellChangeTimes->{{3.948216552253847*^9, 3.948216562047143*^9}, {
  3.9482167353028*^9, 
  3.948216736018662*^9}},ExpressionUUID->"b2c3ce97-23f0-4104-9a8a-\
67c007b4f65a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToESMLogLikelihood", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\<source-data/log_likelihoods_fine_tuned.tsv\>\"", ",", 
       "\"\<Table\>\""}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948216574307705*^9, 3.948216611822275*^9}, {
  3.948216737727241*^9, 3.948216738037854*^9}, {3.948218598938751*^9, 
  3.9482186017036743`*^9}, {3.948373840485716*^9, 3.948373854850747*^9}, {
  3.948374421137889*^9, 3.948374421707507*^9}, {3.948374708663579*^9, 
  3.948374709963379*^9}, {3.948386034665804*^9, 3.948386040842621*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"1f858618-0ec4-4c5c-9b82-e2bb81142648"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import embeddings", "Subsection",
 CellChangeTimes->{{3.948216552253847*^9, 3.948216562047143*^9}, {
  3.948216617854931*^9, 
  3.948216621557588*^9}},ExpressionUUID->"6f61bbd2-e8fe-4b68-bf2a-\
22e24e488c1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToESMEmbedding", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "->", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "&"}], ",", 
     RowBox[{"Import", "[", 
      RowBox[{
      "\"\<source-data/embeddings_fine_tuned.tsv\>\"", ",", "\"\<Table\>\""}],
       "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948216574307705*^9, 3.948216660401973*^9}, {
   3.948216740429851*^9, 3.948216740763382*^9}, 3.948218605719941*^9, {
   3.948373860983567*^9, 3.9483738984329987`*^9}, {3.948374654053316*^9, 
   3.9483746554881077`*^9}, {3.948386045995055*^9, 3.9483860496979303`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"ec1becad-1e03-4a76-8318-a40185f1933c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rootEmbedding", "=", 
   RowBox[{"\"\<NODE_0000000\>\"", "/.", "variantToESMEmbedding"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948374605716004*^9, 3.948374619772455*^9}, {
  3.9483746993688087`*^9, 3.948374705107134*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"04985015-1959-419f-87f8-d3c0a3972ab7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variants", "Section",
 CellChangeTimes->{{3.939748370598116*^9, 
  3.939748372143038*^9}},ExpressionUUID->"b7f21430-bc39-4d06-aa31-\
cad102be6abe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatheredVariants", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"variantFitnessData", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.939748373252368*^9, 3.939748377778625*^9}, {
   3.939748444665161*^9, 3.939748460008875*^9}, 3.940095722591608*^9, {
   3.948386080056395*^9, 3.948386081119996*^9}, {3.9484894915487823`*^9, 
   3.948489559712389*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"1abeab3a-8903-440a-b316-fdd29a22e347"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "gatheredVariants", "]"}]], "Input",
 CellChangeTimes->{{3.939748466015032*^9, 3.939748469310967*^9}, 
   3.948489526746578*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"5082d2fb-cdfc-42a0-a23a-8cda8c49d2ce"],

Cell[BoxData["367"], "Output",
 CellChangeTimes->{
  3.9397484696956463`*^9, 3.9397491502528667`*^9, 3.939750130468667*^9, 
   3.9397501745154963`*^9, 3.939751173618648*^9, {3.939751438699511*^9, 
   3.939751460919026*^9}, 3.9397523549568253`*^9, 3.939752541961151*^9, 
   3.939752606147545*^9, 3.939752693580361*^9, {3.939753085163254*^9, 
   3.939753125898329*^9}, {3.939753172242568*^9, 3.939753222966064*^9}, 
   3.93975325303209*^9, 3.939753285017063*^9, 3.940094850481802*^9, 
   3.9400948938599787`*^9, 3.940094995711996*^9, 3.940095062723386*^9, 
   3.9400957398740788`*^9, 3.940345616031706*^9, {3.940345670198433*^9, 
   3.9403458000487127`*^9}, 3.940345855338036*^9, 3.940345888884221*^9, {
   3.940345935602646*^9, 3.940345952743473*^9}, 3.94034846896332*^9, {
   3.940350076586487*^9, 3.940350119007066*^9}, 3.948215470775298*^9, 
   3.948216454678512*^9, 3.9482208547702627`*^9, 3.948220901013748*^9, 
   3.948221080839157*^9, 3.948221134543909*^9, 3.948374002051465*^9, 
   3.9483741368076687`*^9, 3.948374348988784*^9, 3.948374427636709*^9, 
   3.948374517244239*^9, 3.948374715875203*^9, 3.9483860560035143`*^9, 
   3.948386087306921*^9, 3.948386776411729*^9, 3.9483912712864103`*^9, 
   3.948391597249798*^9, 3.948461176923089*^9, 3.948464575482978*^9, 
   3.9484876246998997`*^9, {3.94848952392931*^9, 3.948489527195315*^9}, 
   3.948489561778055*^9, 3.94849063168711*^9, 3.948492273206007*^9, 
   3.948492941536408*^9, 3.948550505316308*^9, 3.948551747318692*^9, 
   3.948552183593624*^9, 3.948552385113049*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"aba6a409-045d-42ee-ab45-caf517bf5d3f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"variantToColor", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "->", "#2"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"gatheredVariants", ",", 
         RowBox[{"makeColors", "[", 
          RowBox[{"Length", "[", "gatheredVariants", "]"}], "]"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"\"\<other\>\"", "->", "Gray"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.936834868589796*^9, 3.936834877169818*^9}, {
   3.9368349259016123`*^9, 3.9368349285780983`*^9}, {3.936835087243414*^9, 
   3.936835095489607*^9}, {3.9371430590579042`*^9, 3.937143070718974*^9}, {
   3.939664319814328*^9, 3.939664322918647*^9}, {3.93966438905376*^9, 
   3.939664390942543*^9}, {3.939748675318459*^9, 3.939748688796936*^9}, 
   3.940095719218362*^9, {3.9484895377248077`*^9, 3.9484895725185966`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"7d73aaf9-2d24-4e9c-b104-f085f90feb8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combined across all timepoints", "Section",
 CellChangeTimes->{{3.94849260726096*^9, 3.948492608379672*^9}, {
  3.948549527654298*^9, 
  3.948549534374773*^9}},ExpressionUUID->"6ba7fb4d-398d-47eb-8ad8-\
321179127414"],

Cell[BoxData[
 RowBox[{
  RowBox[{"branchesForTimepoint", "[", 
   RowBox[{"countFunction_", ",", "timepoint_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variantToLogFitness", ",", "variantToParent", ",", 
      "branchesVariantToParent", ",", "branches"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"variantToLogFitness", "=", 
      RowBox[{"variantLogFitnessesForTimepoint", "[", "timepoint", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"variantToParent", "=", 
      RowBox[{"variantToParentForTimepoint", "[", "timepoint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"branchesVariantToParent", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"variantToParent", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"countFunction", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"countFunction", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToLogFitness", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToLogFitness", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"branches", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "->", "v"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"v", "/.", "countFunction"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"p", "/.", "countFunction"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"v", "/.", "variantToLogFitness"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"p", "/.", "variantToLogFitness"}], ")"}]}]}], "}"}]}],
           "]"}], "&"}], ",", "branchesVariantToParent"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "branches"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.948492629351716*^9, 3.9484926725531273`*^9}, {
  3.9484927103210583`*^9, 3.9484927104992437`*^9}, {3.948492792751528*^9, 
  3.948492798392044*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"3cba45de-e752-4f6f-a6ed-d59a8f73f14e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
   RowBox[{"countFunction_", ",", "xLabel_", ",", 
    RowBox[{"xMin_", ":", 
     RowBox[{"-", "10"}]}], ",", 
    RowBox[{"xMax_", ":", 
     RowBox[{"+", "15"}]}], ",", 
    RowBox[{"timepoints_", ":", "timepoints"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "branches", ",", "lm", ",", "slope", ",", "doubling", ",", "rsquared", 
      ",", "pearson", ",", " ", "spearman", ",", "pointsPanel", ",", 
      "modelPanel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"branches", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"branchesForTimepoint", "[", 
           RowBox[{"countFunction", ",", "timepoint"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"timepoint", ",", "timepoints"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"branches", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"branches", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">=", "xMin"}], "&&", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<=", "xMax"}]}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lm", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slope", "=", 
      RowBox[{
       RowBox[{"lm", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"doubling", "=", 
      RowBox[{
       RowBox[{"Log", "[", "2", "]"}], "/", "slope"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsquared", "=", 
      RowBox[{"lm", "[", "\"\<RSquared\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pearson", "=", 
      RowBox[{"Sqrt", "[", "rsquared", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spearman", "=", 
      RowBox[{"SpearmanRho", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], ",", 
          RowBox[{"branches", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xMin", ",", "xMax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.3"}], ",", "0.7"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "->", "230"}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xLabel", ",", "\"\<Change in log fitness\>\""}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "False"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Bullet]\>\"", ",", 
           RowBox[{"AbsolutePointSize", "[", "25", "]"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<slope = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"slope", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<doubling = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"doubling", ",", "0.1"}], "]"}], "]"}], "<>", 
              "\"\< muts\>\""}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.92"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{
             "\"\<\!\(\*StyleBox[\"r\",FontSlant->\"Italic\"]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"pearson", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.84"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<\[Rho] = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"spearman", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.76"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.75"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"branch", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "variantToColor"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"branch", ",", "branches"}], "}"}]}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"modelPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"lm", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"pointsPanel", ",", "modelPanel"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.94849273788554*^9, 3.948492838960367*^9}, {
  3.9484930025933027`*^9, 3.948493008268017*^9}, {3.948547963142706*^9, 
  3.9485480344185143`*^9}, {3.9485480743412743`*^9, 3.948548105552561*^9}, {
  3.948549305203766*^9, 3.948549310275508*^9}, {3.948549423225999*^9, 
  3.9485494265095043`*^9}, {3.948549460363921*^9, 3.9485494830832043`*^9}, {
  3.9485495627599077`*^9, 3.948549569558997*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"f3472e72-08d7-4669-98fb-97ec61f77e22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
   RowBox[{"variantToS1Count", ",", "\"\<Change in S1 mutations\>\""}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.94849282701438*^9, 3.948492841905427*^9}, {
   3.948548024676196*^9, 3.948548028621315*^9}, {3.9485493149745913`*^9, 
   3.9485493157475443`*^9}, 3.948549347462694*^9, 3.9485505288051*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"691865ec-d759-4809-92d8-1432240bf9e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figNucVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToNucCount", ",", "\"\<Change in nuc mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948390165629554*^9, 3.948390174542282*^9}, 
   3.9483906617830133`*^9, 3.948492936289173*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"50975097-35cc-41b7-a61f-8dd9ad0bdc3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figSpikeVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToSpikeCount", ",", "\"\<Change in spike mutations\>\""}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390064039474*^9}, {3.948390111343937*^9, 
   3.948390115903878*^9}, 3.948390659229607*^9, 3.948492937512411*^9, {
   3.948493110277502*^9, 3.9484931234943953`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"542744e5-7bf7-4ef5-83a6-5f762d8bb2c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figS1VsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToS1Count", ",", "\"\<Change in S1 mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.94839012428318*^9}, 3.948390657124446*^9, 3.948492938616845*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"be13f1a2-15f5-43e9-a025-bc04a2cdfd3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figS2VsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToS2Count", ",", "\"\<Change in S2 mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, 3.948390654662054*^9, 3.948492939698723*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"30ee788a-e91e-4c3b-acf0-bfc838636665"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figNTDVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToNTDCount", ",", "\"\<Change in NTD mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390253374292*^9}, 
   3.9483906521890182`*^9, 3.948492940871935*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"50e852f9-94f2-43a3-835a-5d6559c2eabf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figRBDVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{"variantToRBDCount", ",", "\"\<Change in RBD mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"870d55ca-a11d-4eeb-aba4-48ab9cf4877c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figORF1abVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToORF1abCount", ",", "\"\<Change in ORF1ab mutations\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.9483903488824167`*^9}, 3.948390647480555*^9, 
   3.948492946569075*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"17eb20e6-0a91-43df-b1d3-cc8daf1731de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figAccessoryVsFitness", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToAccessoryCount", ",", "\"\<Change in accessory mutations\>\""}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.948390377169726*^9}, 3.9483906448914137`*^9, 
   3.948492948021639*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"deaf45d5-d3d4-43d9-9105-e0dafaa29139"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figScatter", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "figS1VsFitness", ",", "figS2VsFitness", ",", "figNTDVsFitness"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "figRBDVsFitness", ",", "figORF1abVsFitness", ",", 
         "figAccessoryVsFitness"}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483904236903667`*^9, 3.948390485827319*^9}, {
   3.948390542788011*^9, 3.948390545656624*^9}, {3.9483914566520977`*^9, 
   3.948391458473205*^9}, 3.9483915118293457`*^9, 3.948492949230165*^9, 
   3.94855036223062*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"e8b97618-e7b1-4b02-86a2-4ed3cc63091b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<figures/\>\"", "<>", "virus", "<>", "\"\<_\>\"", "<>", 
    "\"\<lineage_delta_mut_fitness_scatter.png\>\""}], ",", "figScatter", 
   ",", "\"\<PNG\>\"", ",", 
   RowBox[{"ImageResolution", "->", "300"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9397505315574083`*^9, 3.939750583865226*^9}, {
  3.939750742358802*^9, 3.939750748930786*^9}, {3.939753160383626*^9, 
  3.939753189677678*^9}, {3.9400954792277727`*^9, 3.9400954816674347`*^9}, {
  3.948388856847913*^9, 3.9483888571223*^9}, {3.948390629459423*^9, 
  3.9483906369987307`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"1dd6e8f6-af49-4669-a356-94bac61c85b8"],

Cell[BoxData["\<\"figures/sarscov2_lineage_delta_mut_fitness_scatter.png\"\>"]\
, "Output",
 CellChangeTimes->{{3.93975319165231*^9, 3.939753253793496*^9}, 
   3.939753285776197*^9, 3.940094895289599*^9, 3.940094996644052*^9, 
   3.9400950635957212`*^9, {3.940095454812036*^9, 3.940095482326253*^9}, 
   3.940095742169311*^9, 3.940345618043851*^9, {3.94034567225385*^9, 
   3.940345801689547*^9}, 3.940345857781776*^9, 3.94034589051402*^9, {
   3.940345937253626*^9, 3.940345954434021*^9}, {3.9403500799911537`*^9, 
   3.940350121675539*^9}, 3.948215472949953*^9, 3.948216456780086*^9, 
   3.9482208571941433`*^9, 3.9482209044044333`*^9, 3.94822108324681*^9, 
   3.9482211369399977`*^9, 3.9483741392576447`*^9, 3.948374351610532*^9, 
   3.948374429944425*^9, 3.948374519547695*^9, 3.948374718153689*^9, {
   3.9483872209347343`*^9, 3.9483872485900497`*^9}, 3.948388858038622*^9, 
   3.948388893411483*^9, 3.948389332972106*^9, 3.9483906388062763`*^9, 
   3.94839067522182*^9, 3.9483909488422403`*^9, 3.94839128509494*^9, {
   3.9483914291249733`*^9, 3.948391453560453*^9}, 3.948391607668029*^9, 
   3.948461183055757*^9, 3.948464581499071*^9, 3.948487641677178*^9, 
   3.948493085193138*^9, 3.94854922342349*^9, 3.9485493322927647`*^9, 
   3.948549371541853*^9, 3.948549443384697*^9, 3.9485494941465597`*^9, 
   3.948549591864464*^9, 3.9485505132714252`*^9, 3.948551754713615*^9, 
   3.948552191187044*^9, 3.948552392644669*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"9ec25bbd-57d1-41e4-8720-d4a2ed792885"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Early vs late split", "Section",
 CellChangeTimes->{{3.9485495869973516`*^9, 
  3.948549597816197*^9}},ExpressionUUID->"b5b40502-6a9a-4586-8f7c-\
010641314169"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"earlyTimepoints", "=", 
  RowBox[{"timepoints", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "4"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.94854962107815*^9, 3.948549633085803*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"2e94adcc-6fd3-47aa-bdff-8a0e92c4bdbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"2020\"\>", ",", "\<\"2020-21\"\>", ",", "\<\"2021\"\>", 
   ",", "\<\"2021-22\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.94854963344248*^9, {3.948549940256098*^9, 3.948549946449318*^9}, 
   3.948550513346324*^9, 3.9485517547498417`*^9, 3.948552191227481*^9, 
   3.948552392712071*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"eabb5510-5b1c-4629-99ef-eeec59498977"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lateTimepoints", "=", 
  RowBox[{"timepoints", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"-", "4"}], ";;", 
     RowBox[{"-", "1"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.94854962107815*^9, 3.948549641652935*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"e717343d-0a0f-4584-953e-97039536ad00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"2022-23\"\>", ",", "\<\"2023\"\>", ",", "\<\"2023-24\"\>", 
   ",", "\<\"2024\"\>"}], "}"}]], "Output",
 CellChangeTimes->{
  3.948549642109473*^9, {3.948549940298788*^9, 3.94854994648251*^9}, 
   3.948550513350875*^9, 3.948551754757642*^9, 3.9485521912325897`*^9, 
   3.9485523927163563`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"94efbdb8-9197-4d40-8367-e0811adf2457"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
   RowBox[{"variantToS1Count", ",", "\"\<Change in S1 mutations\>\"", ",", 
    RowBox[{"-", "10"}], ",", "15", ",", "earlyTimepoints"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.94849282701438*^9, 3.948492841905427*^9}, {
   3.948548024676196*^9, 3.948548028621315*^9}, {3.9485493149745913`*^9, 
   3.9485493157475443`*^9}, 3.948549347462694*^9, {3.9485496095201883`*^9, 
   3.9485496467546673`*^9}, 3.948549943279332*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"15acd896-80dc-4e58-9403-46ca31ed3d84"],

Cell["Early", "Text",
 CellChangeTimes->{{3.948549671964526*^9, 
  3.948549672529303*^9}},ExpressionUUID->"495d0874-47d7-443e-aea3-\
f672e57fd22b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figRBDVsFitnessEarly", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToRBDCount", ",", "\"\<Change in RBD mutations\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "earlyTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9, {3.9485496962095757`*^9, 
   3.94854971439428*^9}, 3.948549937717609*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"22be6d32-b64c-45c4-8c10-d7eb16b0ca98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figORF1abVsFitnessEarly", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToORF1abCount", ",", "\"\<Change in ORF1ab mutations\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "earlyTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.9483903488824167`*^9}, 3.948390647480555*^9, 
   3.948492946569075*^9, {3.948549722187244*^9, 3.948549744919291*^9}, 
   3.948549935366398*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"5a9988b4-3c56-4995-9340-40c12fe62a49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figAccessoryVsFitnessEarly", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToAccessoryCount", ",", "\"\<Change in accessory mutations\>\"", 
     ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "earlyTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.948390377169726*^9}, 3.9483906448914137`*^9, 
   3.948492948021639*^9, {3.948549723548358*^9, 3.948549754341461*^9}, 
   3.94854993350919*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"de31a0ed-d181-46cd-991d-31469737e79b"],

Cell["Late", "Text",
 CellChangeTimes->{{3.948549731710491*^9, 
  3.948549732134761*^9}},ExpressionUUID->"5b59fe7b-9d9f-445c-a28f-\
d9f330541e92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figRBDVsFitnessLate", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToRBDCount", ",", "\"\<Change in RBD mutations\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "lateTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9, {3.9485496962095757`*^9, 
   3.94854971439428*^9}, {3.948549769374057*^9, 3.9485497743878813`*^9}, 
   3.948549926590735*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"615b1113-bab5-44be-9664-401a1dba657a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figORF1abVsFitnessLate", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToORF1abCount", ",", "\"\<Change in ORF1ab mutations\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "lateTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.9483903488824167`*^9}, 3.948390647480555*^9, 
   3.948492946569075*^9, {3.948549722187244*^9, 3.948549744919291*^9}, {
   3.948549779669353*^9, 3.948549784210747*^9}, 3.948549928074341*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"4e505825-3281-452b-86e2-754726066548"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figAccessoryVsFitnessLate", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToAccessoryCount", ",", "\"\<Change in accessory mutations\>\"", 
     ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "lateTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, {
   3.948390334589569*^9, 3.948390377169726*^9}, 3.9483906448914137`*^9, 
   3.948492948021639*^9, {3.948549723548358*^9, 3.948549754341461*^9}, {
   3.9485497888752623`*^9, 3.948549799223812*^9}, 3.948549929632395*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"1fbb23d1-e1da-4ba1-b17f-d48e9a173d10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figScatterSplit", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{"figRBDVsFitnessEarly", ",", 
           RowBox[{"Text", "[", "\"\<Jan 2020 to Jun 2022\>\"", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}]}], "]"}], ",", 
         "figORF1abVsFitnessEarly", ",", "figAccessoryVsFitnessEarly"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{"figRBDVsFitnessLate", ",", 
           RowBox[{"Text", "[", "\"\<Jul 2022 to Dec 2024\>\"", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}]}], "]"}], ",", 
         "figORF1abVsFitnessLate", ",", "figAccessoryVsFitnessLate"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483904236903667`*^9, 3.948390485827319*^9}, {
   3.948390542788011*^9, 3.948390545656624*^9}, {3.9483914566520977`*^9, 
   3.948391458473205*^9}, 3.9483915118293457`*^9, 3.948492949230165*^9, {
   3.94854980341293*^9, 3.948549832400264*^9}, {3.948549901917424*^9, 
   3.9485499221181993`*^9}, {3.948549960115933*^9, 3.948549969790512*^9}, {
   3.948550007564824*^9, 3.948550055629409*^9}, {3.9485501110236893`*^9, 
   3.948550113573099*^9}, {3.9485501578149643`*^9, 3.948550216999823*^9}, 
   3.948550366251274*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"d3d3844f-cb6e-4d31-bd6e-011b4753cc06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<figures/\>\"", "<>", "virus", "<>", "\"\<_\>\"", "<>", 
    "\"\<lineage_delta_mut_fitness_scatter_split.png\>\""}], ",", 
   "figScatterSplit", ",", "\"\<PNG\>\"", ",", 
   RowBox[{"ImageResolution", "->", "300"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9397505315574083`*^9, 3.939750583865226*^9}, {
  3.939750742358802*^9, 3.939750748930786*^9}, {3.939753160383626*^9, 
  3.939753189677678*^9}, {3.9400954792277727`*^9, 3.9400954816674347`*^9}, {
  3.948388856847913*^9, 3.9483888571223*^9}, {3.948390629459423*^9, 
  3.9483906369987307`*^9}, {3.948550282009326*^9, 3.948550286806052*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"166c5464-0d02-49b2-a869-8de22d26da9e"],

Cell[BoxData["\<\"figures/sarscov2_lineage_delta_mut_fitness_scatter_split.\
png\"\>"], "Output",
 CellChangeTimes->{{3.93975319165231*^9, 3.939753253793496*^9}, 
   3.939753285776197*^9, 3.940094895289599*^9, 3.940094996644052*^9, 
   3.9400950635957212`*^9, {3.940095454812036*^9, 3.940095482326253*^9}, 
   3.940095742169311*^9, 3.940345618043851*^9, {3.94034567225385*^9, 
   3.940345801689547*^9}, 3.940345857781776*^9, 3.94034589051402*^9, {
   3.940345937253626*^9, 3.940345954434021*^9}, {3.9403500799911537`*^9, 
   3.940350121675539*^9}, 3.948215472949953*^9, 3.948216456780086*^9, 
   3.9482208571941433`*^9, 3.9482209044044333`*^9, 3.94822108324681*^9, 
   3.9482211369399977`*^9, 3.9483741392576447`*^9, 3.948374351610532*^9, 
   3.948374429944425*^9, 3.948374519547695*^9, 3.948374718153689*^9, {
   3.9483872209347343`*^9, 3.9483872485900497`*^9}, 3.948388858038622*^9, 
   3.948388893411483*^9, 3.948389332972106*^9, 3.9483906388062763`*^9, 
   3.94839067522182*^9, 3.9483909488422403`*^9, 3.94839128509494*^9, {
   3.9483914291249733`*^9, 3.948391453560453*^9}, 3.948391607668029*^9, 
   3.948461183055757*^9, 3.948464581499071*^9, 3.948487641677178*^9, 
   3.948493085193138*^9, 3.94854922342349*^9, 3.9485493322927647`*^9, 
   3.948549371541853*^9, 3.948549443384697*^9, 3.9485494941465597`*^9, 
   3.948549591864464*^9, 3.9485502885548973`*^9, 3.9485505160820436`*^9, 
   3.948551757900177*^9, 3.948552194017049*^9, 3.948552395851726*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"056a9739-ad95-4918-bb42-76480980868f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Through time", "Section",
 CellChangeTimes->{{3.948463285167205*^9, 3.948463287895112*^9}, {
  3.948489607946258*^9, 3.948489608130773*^9}, {3.948492603866707*^9, 
  3.948492605146448*^9}},ExpressionUUID->"0061e3a7-5b2a-4d90-9b5a-\
5f2a114900c5"],

Cell["Directly from individual timepoints", "Text",
 CellChangeTimes->{{3.9484632901085033`*^9, 
  3.948463299664097*^9}},ExpressionUUID->"5727d3ef-10e5-4fbc-8364-\
22b4c1340959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotForTimepoint", "[", 
   RowBox[{
   "countFunction_", ",", "xLabel_", ",", "timepoint_", ",", "xMin_", ",", 
    "xMax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variantToLogFitness", ",", "variantToParent", ",", 
      "branchesVariantToParent", ",", "branches", ",", "lm", ",", "slope", 
      ",", "doubling", ",", "rsquared", ",", "pearson", ",", "spearman", ",", 
      "pointsPanel", ",", "modelPanel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"branches", "=", 
      RowBox[{"branchesForTimepoint", "[", 
       RowBox[{"countFunction", ",", "timepoint"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"branches", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"branches", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">=", "xMin"}], "&&", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<=", "xMax"}]}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lm", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slope", "=", 
      RowBox[{
       RowBox[{"lm", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"doubling", "=", 
      RowBox[{
       RowBox[{"Log", "[", "2", "]"}], "/", "slope"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsquared", "=", 
      RowBox[{"lm", "[", "\"\<RSquared\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pearson", "=", 
      RowBox[{"Sqrt", "[", "rsquared", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spearman", "=", 
      RowBox[{"SpearmanRho", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Tooltip", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}], "]"}], "]"}], "}"}], ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
          "branches"}], "]"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.3"}], ",", "0.7"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "->", "230"}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xLabel", ",", "\"\<Change in log fitness\>\""}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "False"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Bullet]\>\"", ",", 
           RowBox[{"AbsolutePointSize", "[", "25", "]"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<slope = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"slope", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<doubling = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"doubling", ",", "0.1"}], "]"}], "]"}], "<>", 
              "\"\< muts\>\""}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.92"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{
             "\"\<\!\(\*StyleBox[\"r\",FontSlant->\"Italic\"]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"pearson", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.84"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<\[Rho] = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"spearman", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.76"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.75"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"branch", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "variantToColor"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"branch", ",", "branches"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "timepoint"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"modelPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"lm", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{"All", ",", "All"}], "}"}]}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"pointsPanel", ",", "modelPanel"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.948463661381173*^9, 3.948463696046689*^9}, {
  3.9484637711616488`*^9, 3.948463775058229*^9}, {3.948465396551832*^9, 
  3.948465402869701*^9}, {3.948489650516572*^9, 3.948489707551347*^9}, {
  3.948490226828877*^9, 3.948490227305305*^9}, {3.9484908715274963`*^9, 
  3.948490969220552*^9}, {3.948491017111932*^9, 3.948491021176983*^9}, {
  3.948547044128578*^9, 3.948547142002337*^9}, {3.948547282703545*^9, 
  3.948547293833606*^9}, {3.948547351812195*^9, 3.9485475353380136`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"f405e2dd-43d3-4968-b4ac-97ae4cae5959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotForTimepoint", "[", 
   RowBox[{
   "variantToS1Count", ",", "\"\<Change in S1 mutations\>\"", ",", 
    "\"\<2021\>\"", ",", 
    RowBox[{"-", "8"}], ",", 
    RowBox[{"+", "8"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948490993016758*^9, 3.948491005059187*^9}, {
   3.948493720884049*^9, 3.9484937284427557`*^9}, {3.9485471457801733`*^9, 
   3.948547180427104*^9}, 3.948550371389407*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"f404a1e7-a082-4dfa-8294-fa0221673012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{"countFunction_", ",", "xLabel_", ",", "xMin_", ",", "xMax_"}], 
   "]"}], ":=", 
  RowBox[{"Grid", "[", 
   RowBox[{"gappedPartition", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"mutVsFitnessScatterPlotForTimepoint", "[", 
        RowBox[{
        "countFunction", ",", "xLabel", ",", "timepoint", ",", "xMin", ",", 
         "xMax"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"timepoint", ",", "timepoints"}], "}"}]}], "]"}], ",", "4"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.948463076162829*^9, 3.9484630973299093`*^9}, {
  3.9484638165433207`*^9, 3.9484638498779716`*^9}, {3.948493793807561*^9, 
  3.948493795194833*^9}, {3.94849401442842*^9, 3.9484940152456284`*^9}, {
  3.9485472321653767`*^9, 3.948547243160636*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"ec57c78e-0689-4977-923d-601f05e85bb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{
   "variantToSpikeCount", ",", "\"\<Change in spike mutations\>\"", ",", 
    RowBox[{"-", "8"}], ",", "8"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9484931765867777`*^9, 3.948493182004216*^9}, {
   3.948547249045734*^9, 3.9485472515174417`*^9}, 3.948550376842991*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"247e33f0-cd03-415a-ac76-1c533689177d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{"variantToS1Count", ",", "\"\<Change in S1 mutations\>\"", ",", 
    RowBox[{"-", "8"}], ",", "8"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948463850862267*^9, 3.948463864821783*^9}, {
   3.948547577012491*^9, 3.948547578350102*^9}, 3.948550379762724*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"7dc6550e-9373-4a35-a4b6-ced7f0a13b70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{"variantToRBDCount", ",", "\"\<Change in RBD mutations\>\"", ",", 
    RowBox[{"-", "8"}], ",", "8"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948463850862267*^9, 3.948463864821783*^9}, {
   3.9484655035974503`*^9, 3.948465508719301*^9}, {3.948547583324513*^9, 
   3.948547585420292*^9}, 3.948550382238029*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"d0be0e3d-ef71-4d60-8a6b-9974b59b9362"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{
   "variantToORF1abCount", ",", "\"\<Change in ORF1ab mutations\>\"", ",", 
    RowBox[{"-", "8"}], ",", "8"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948463850862267*^9, 3.948463864821783*^9}, {
   3.9484655035974503`*^9, 3.948465535576415*^9}, {3.9485475919904222`*^9, 
   3.948547593386757*^9}, 3.948550386433249*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"7d7fe0d8-84be-48f2-8d68-dd758c03baa1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timePointsGrid", "[", 
   RowBox[{
   "variantToAccessoryCount", ",", "\"\<Change in accessory mutations\>\"", 
    ",", 
    RowBox[{"-", "8"}], ",", "8"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948463850862267*^9, 3.948463864821783*^9}, {
   3.9484655035974503`*^9, 3.948465535576415*^9}, {3.9484655737402287`*^9, 
   3.94846558153721*^9}, {3.9485475987753887`*^9, 3.9485475999812307`*^9}, 
   3.948550388987685*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"57d59f0e-a38e-422c-b921-e18279d64b9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["EvEscape correlation", "Section",
 CellChangeTimes->{{3.948550540376429*^9, 
  3.948550544599475*^9}},ExpressionUUID->"18b2f48d-c537-4fb1-83c8-\
1227aa06dae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figEvEscapeVsFitnessCombined", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToEvEscape", ",", 
     "\"\<Change in EvEscape score (Jan 20 to Dec 24)\>\"", ",", 
     RowBox[{"-", "25"}], ",", "50"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948550588318028*^9, 3.948550601422861*^9}, {
   3.9485510238484077`*^9, 3.948551111529189*^9}, {3.9485515256949053`*^9, 
   3.948551529877627*^9}, 3.948551626639201*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"3b885614-f67d-4349-81da-33332ad8bfdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figEvEscapeVsFitnessEarly", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToEvEscape", ",", 
     "\"\<Change in EvEscape score (Jan 20 to Jun 22)\>\"", ",", 
     RowBox[{"-", "25"}], ",", "50", ",", "earlyTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948550588318028*^9, 3.948550601422861*^9}, {
   3.9485510238484077`*^9, 3.94855108407899*^9}, {3.9485511153563423`*^9, 
   3.9485511242002*^9}, {3.948551515836562*^9, 3.948551523301009*^9}, 
   3.948551623795537*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"7f206a50-20f8-4089-97af-863b62b8d526"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figEvEscapeVsFitnessLate", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToEvEscape", ",", 
     "\"\<Change in EvEscape score (July 22 to Dec 24)\>\"", ",", 
     RowBox[{"-", "25"}], ",", "50", ",", "lateTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948550588318028*^9, 3.948550601422861*^9}, {
   3.9485510238484077`*^9, 3.94855108407899*^9}, {3.9485511153563423`*^9, 
   3.9485511507051497`*^9}, {3.948551512203223*^9, 3.9485515141722507`*^9}, 
   3.948551621254808*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"31d650c0-222e-4a7c-882d-16990bd4ae87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figSpikeVsFitnessCombined", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToSpikeCount", ",", 
     "\"\<Change in spike mutations (Jan 20 to Dec 24)\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9, {3.9485496962095757`*^9, 
   3.94854971439428*^9}, 3.948549937717609*^9, {3.948551207951193*^9, 
   3.948551244087895*^9}, {3.9485514377135878`*^9, 3.948551441306981*^9}, {
   3.948551475282551*^9, 3.948551480431212*^9}, 3.948551619087474*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"1200698c-4575-4d83-8236-ae799285e083"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figSpikeVsFitnessEarly", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToSpikeCount", ",", 
     "\"\<Change in spike mutations (Jan 20 to Jun 22)\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "earlyTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9, {3.9485496962095757`*^9, 
   3.94854971439428*^9}, 3.948549937717609*^9, {3.948551207951193*^9, 
   3.948551220464293*^9}, {3.948551450831246*^9, 3.948551470701906*^9}, 
   3.9485516161528263`*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"5b8f3fe2-6526-42eb-934f-cfdb9965f6b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figSpikeVsFitnessLate", "=", 
   RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
    RowBox[{
    "variantToSpikeCount", ",", 
     "\"\<Change in spike mutations (July 22 to Dec 24)\>\"", ",", 
     RowBox[{"-", "10"}], ",", "15", ",", "lateTimepoints"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.948389958817836*^9, 3.948389966439928*^9}, {
   3.948390056730698*^9, 3.948390088308099*^9}, {3.948390121614119*^9, 
   3.948390156987977*^9}, {3.948390242833537*^9, 3.948390277780987*^9}, 
   3.948390650158799*^9, 3.94849294200334*^9, {3.9485496962095757`*^9, 
   3.94854971439428*^9}, 3.948549937717609*^9, {3.948551207951193*^9, 
   3.9485512312569427`*^9}, {3.948551489185087*^9, 3.948551495564891*^9}, {
   3.948551609296247*^9, 3.9485516145792103`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"830cef9e-1b07-47cc-bab2-85ae489ebbb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"figScatterEvEscape", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{"figSpikeVsFitnessCombined", ",", 
           RowBox[{"Text", "[", "\"\<Spike mutation count\>\"", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}]}], "]"}], ",", 
         "figSpikeVsFitnessEarly", ",", "figSpikeVsFitnessLate"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{"figEvEscapeVsFitnessCombined", ",", 
           RowBox[{"Text", "[", "\"\<EvEscape score\>\"", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}]}], "]"}], ",", 
         "figEvEscapeVsFitnessEarly", ",", "figEvEscapeVsFitnessLate"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9483904236903667`*^9, 3.948390485827319*^9}, {
   3.948390542788011*^9, 3.948390545656624*^9}, {3.9483914566520977`*^9, 
   3.948391458473205*^9}, 3.9483915118293457`*^9, 3.948492949230165*^9, {
   3.94854980341293*^9, 3.948549832400264*^9}, {3.948549901917424*^9, 
   3.9485499221181993`*^9}, {3.948549960115933*^9, 3.948549969790512*^9}, {
   3.948550007564824*^9, 3.948550055629409*^9}, {3.9485501110236893`*^9, 
   3.948550113573099*^9}, {3.9485501578149643`*^9, 3.948550216999823*^9}, 
   3.948550366251274*^9, {3.948551260901704*^9, 3.9485513185245953`*^9}, {
   3.948551405469941*^9, 3.948551422455083*^9}, 3.948552324673009*^9},
 CellLabel->"In[85]:=",ExpressionUUID->"9e78d916-1d55-4ea3-a515-785a0eba0b8f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<figures/\>\"", "<>", "virus", "<>", "\"\<_\>\"", "<>", 
    "\"\<lineage_delta_evescape_fitness_scatter.png\>\""}], ",", 
   "figScatterEvEscape", ",", "\"\<PNG\>\"", ",", 
   RowBox[{"ImageResolution", "->", "300"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9397505315574083`*^9, 3.939750583865226*^9}, {
  3.939750742358802*^9, 3.939750748930786*^9}, {3.939753160383626*^9, 
  3.939753189677678*^9}, {3.9400954792277727`*^9, 3.9400954816674347`*^9}, {
  3.948388856847913*^9, 3.9483888571223*^9}, {3.948390629459423*^9, 
  3.9483906369987307`*^9}, {3.948550282009326*^9, 3.948550286806052*^9}, {
  3.948551323372931*^9, 3.9485513307836933`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"ad7048b8-975d-4c78-9ede-7533a5cf20d3"],

Cell[BoxData["\<\"figures/sarscov2_lineage_delta_evescape_fitness_scatter.png\
\"\>"], "Output",
 CellChangeTimes->{{3.93975319165231*^9, 3.939753253793496*^9}, 
   3.939753285776197*^9, 3.940094895289599*^9, 3.940094996644052*^9, 
   3.9400950635957212`*^9, {3.940095454812036*^9, 3.940095482326253*^9}, 
   3.940095742169311*^9, 3.940345618043851*^9, {3.94034567225385*^9, 
   3.940345801689547*^9}, 3.940345857781776*^9, 3.94034589051402*^9, {
   3.940345937253626*^9, 3.940345954434021*^9}, {3.9403500799911537`*^9, 
   3.940350121675539*^9}, 3.948215472949953*^9, 3.948216456780086*^9, 
   3.9482208571941433`*^9, 3.9482209044044333`*^9, 3.94822108324681*^9, 
   3.9482211369399977`*^9, 3.9483741392576447`*^9, 3.948374351610532*^9, 
   3.948374429944425*^9, 3.948374519547695*^9, 3.948374718153689*^9, {
   3.9483872209347343`*^9, 3.9483872485900497`*^9}, 3.948388858038622*^9, 
   3.948388893411483*^9, 3.948389332972106*^9, 3.9483906388062763`*^9, 
   3.94839067522182*^9, 3.9483909488422403`*^9, 3.94839128509494*^9, {
   3.9483914291249733`*^9, 3.948391453560453*^9}, 3.948391607668029*^9, 
   3.948461183055757*^9, 3.948464581499071*^9, 3.948487641677178*^9, 
   3.948493085193138*^9, 3.94854922342349*^9, 3.9485493322927647`*^9, 
   3.948549371541853*^9, 3.948549443384697*^9, 3.9485494941465597`*^9, 
   3.948549591864464*^9, 3.9485502885548973`*^9, 3.9485505160820436`*^9, 
   3.948551334209085*^9, 3.948551538771562*^9, 3.9485516336976547`*^9, 
   3.948551766388541*^9, 3.9485522023190517`*^9, 3.9485524032956867`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"50a64b2b-deb9-4577-a53c-5447f6eb517a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ESM correlation", "Section",
 CellChangeTimes->{{3.948550540376429*^9, 3.948550544599475*^9}, {
  3.94855164684319*^9, 
  3.9485516497615137`*^9}},ExpressionUUID->"40ca2e48-16e2-418c-970f-\
24e2256af33a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esmEmbeddingsBranchesForTimepoint", "[", 
   RowBox[{"function_", ",", "timepoint_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "variantToLogFitness", ",", "variantToParent", ",", 
      "branchesVariantToParent", ",", "branches"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"variantToLogFitness", "=", 
      RowBox[{"variantLogFitnessesForTimepoint", "[", "timepoint", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"variantToParent", "=", 
      RowBox[{"variantToParentForTimepoint", "[", "timepoint", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"branchesVariantToParent", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"variantToParent", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToESMEmbedding", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToESMEmbedding", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToLogFitness", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"variantToLogFitness", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"branches", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"p", "=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"p", "->", "v"}], ",", 
             RowBox[{"function", "[", 
              RowBox[{
               RowBox[{"v", "/.", "variantToESMEmbedding"}], ",", 
               RowBox[{"p", "/.", "variantToESMEmbedding"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"v", "/.", "variantToLogFitness"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"p", "/.", "variantToLogFitness"}], ")"}]}]}], "}"}]}],
           "]"}], "&"}], ",", "branchesVariantToParent"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "branches"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.948492629351716*^9, 3.9484926725531273`*^9}, {
  3.9484927103210583`*^9, 3.9484927104992437`*^9}, {3.948492792751528*^9, 
  3.948492798392044*^9}, {3.94855178941017*^9, 3.948551824689064*^9}, {
  3.948552056646138*^9, 3.94855207637337*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"d9c51eee-2dfd-4b4a-8048-3b73e08d69de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esmEmbeddingsVsFitnessScatterPlotCombined", "[", 
   RowBox[{"function_", ",", "xLabel_", ",", 
    RowBox[{"xMin_", ":", 
     RowBox[{"-", "10"}]}], ",", 
    RowBox[{"xMax_", ":", 
     RowBox[{"+", "15"}]}], ",", 
    RowBox[{"timepoints_", ":", "timepoints"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "branches", ",", "lm", ",", "slope", ",", "doubling", ",", "rsquared", 
      ",", "pearson", ",", " ", "spearman", ",", "pointsPanel", ",", 
      "modelPanel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"branches", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"esmEmbeddingsBranchesForTimepoint", "[", 
           RowBox[{"function", ",", "timepoint"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"timepoint", ",", "timepoints"}], "}"}]}], "]"}], ",", 
        "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"branches", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"branches", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">=", "xMin"}], "&&", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "<=", "xMax"}]}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lm", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slope", "=", 
      RowBox[{
       RowBox[{"lm", "[", "\"\<BestFitParameters\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"doubling", "=", 
      RowBox[{
       RowBox[{"Log", "[", "2", "]"}], "/", "slope"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rsquared", "=", 
      RowBox[{"lm", "[", "\"\<RSquared\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pearson", "=", 
      RowBox[{"Sqrt", "[", "rsquared", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spearman", "=", 
      RowBox[{"SpearmanRho", "[", 
       RowBox[{
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"branches", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pointsPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], ",", 
          RowBox[{"branches", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xMin", ",", "xMax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.3"}], ",", "0.7"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "->", "230"}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"xLabel", ",", "\"\<Change in log fitness\>\""}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "False"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Bullet]\>\"", ",", 
           RowBox[{"AbsolutePointSize", "[", "25", "]"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<slope = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"slope", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "1"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<doubling = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"doubling", ",", "0.1"}], "]"}], "]"}], "<>", 
              "\"\< muts\>\""}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.92"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{
             "\"\<\!\(\*StyleBox[\"r\",FontSlant->\"Italic\"]\) = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"pearson", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.84"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"\"\<\[Rho] = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"spearman", ",", "0.01"}], "]"}], "]"}]}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.02", ",", "0.76"}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.75"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"branch", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "variantToColor"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"branch", ",", "branches"}], "}"}]}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"modelPanel", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"lm", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "100"}], ",", "100"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"PlotRangeClipping", "->", "True"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<FullAxes\>\""}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"Frame", "->", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Dashed"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"pointsPanel", ",", "modelPanel"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.94849273788554*^9, 3.948492838960367*^9}, {
  3.9484930025933027`*^9, 3.948493008268017*^9}, {3.948547963142706*^9, 
  3.9485480344185143`*^9}, {3.9485480743412743`*^9, 3.948548105552561*^9}, {
  3.948549305203766*^9, 3.948549310275508*^9}, {3.948549423225999*^9, 
  3.9485494265095043`*^9}, {3.948549460363921*^9, 3.9485494830832043`*^9}, {
  3.9485495627599077`*^9, 3.948549569558997*^9}, {3.948551745402417*^9, 
  3.948551750180951*^9}, {3.948551834868681*^9, 3.948551840863392*^9}, {
  3.9485520326065693`*^9, 3.9485520466125507`*^9}, {3.948552081819407*^9, 
  3.948552109600066*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"1651b84e-cf0e-4f9b-a35f-f4577a78808e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mutVsFitnessScatterPlotCombined", "[", 
   RowBox[{
   "variantToESMLogLikelihood", ",", "\"\<Change in ESM log likelihood\>\"", 
    ",", 
    RowBox[{"-", "50"}], ",", "10"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948551975351478*^9, 3.9485520045407267`*^9}, 
   3.948552328870771*^9},
 CellLabel->"In[89]:=",ExpressionUUID->"33cbce4e-13f8-40d1-878f-8febf2e38dbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esmEmbeddingsVsFitnessScatterPlotCombined", "[", 
   RowBox[{
   "EuclideanDistance", ",", "\"\<Change in ESM L2 semanticity\>\"", ",", 
    RowBox[{"-", "0.3"}], ",", "1.5"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948550588318028*^9, 3.948550601422861*^9}, {
   3.9485510238484077`*^9, 3.948551111529189*^9}, {3.9485515256949053`*^9, 
   3.948551529877627*^9}, {3.948551626639201*^9, 3.9485516636672153`*^9}, {
   3.9485518498310843`*^9, 3.948551877107985*^9}, {3.9485520883970337`*^9, 
   3.94855212675215*^9}, 3.948552330496325*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"bed4037d-197a-4b05-a4e5-5a84138081ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cosineDistance", "[", 
   RowBox[{"v1_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"1", "-", 
   RowBox[{"Cos", "[", 
    RowBox[{"VectorAngle", "[", 
     RowBox[{"v1", ",", "v2"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.948218330451612*^9, 3.948218342186377*^9}, {
  3.948218456630929*^9, 3.9482184615269136`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"c83fefb6-1c29-41d6-9438-99b9164d969e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esmEmbeddingsVsFitnessScatterPlotCombined", "[", 
   RowBox[{
   "cosineDistance", ",", "\"\<Change in ESM cosine semanticity\>\"", ",", 
    RowBox[{"-", "0.005"}], ",", "0.01"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.948550588318028*^9, 3.948550601422861*^9}, {
   3.9485510238484077`*^9, 3.948551111529189*^9}, {3.9485515256949053`*^9, 
   3.948551529877627*^9}, {3.948551626639201*^9, 3.9485516636672153`*^9}, {
   3.9485518498310843`*^9, 3.948551877107985*^9}, {3.9485520883970337`*^9, 
   3.94855212675215*^9}, {3.948552161842196*^9, 3.948552164461089*^9}, {
   3.948552217791881*^9, 3.948552267772273*^9}, 3.948552332811784*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"d97d4c89-1680-4575-88b1-ed789bf1daf7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1566, 831},
WindowMargins->{{15, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"05f49bb1-a0a3-45cc-8fc3-3e8fd55216ef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 249, 4, 123, "Title",ExpressionUUID->"1813b3bd-5646-490e-8aa0-508f91cba565"],
Cell[CellGroupData[{
Cell[854, 30, 154, 3, 84, "Section",ExpressionUUID->"80101095-f50c-437c-ba5a-84916a951ca7"],
Cell[1011, 35, 598, 12, 37, "Input",ExpressionUUID->"cf3e29ae-95d2-4b38-b833-953c967c6703"],
Cell[1612, 49, 723, 11, 37, "Input",ExpressionUUID->"f7ca955f-ff30-47b6-9e04-741479a8280b"],
Cell[CellGroupData[{
Cell[2360, 64, 250, 4, 37, "Input",ExpressionUUID->"599a5b7f-b57c-4745-bd7f-ca487a6914b4"],
Cell[2613, 70, 3740, 52, 42, "Output",ExpressionUUID->"0fa57823-a336-4012-be69-c5c3057a93f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6390, 127, 491, 12, 37, "Input",ExpressionUUID->"1b14dcae-da8a-4ce4-98e7-4d871df57bbf"],
Cell[6884, 141, 3997, 63, 147, "Output",ExpressionUUID->"a4fa241a-e5a4-4da7-b729-401258ccf0cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10918, 209, 968, 26, 37, "Input",ExpressionUUID->"c3341a69-bca0-4528-ae47-87d5e9d7bb60"],
Cell[11889, 237, 3031, 44, 42, "Output",ExpressionUUID->"6494f930-7e26-44c2-aa1c-da6f7da48fc2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14969, 287, 229, 4, 84, "Section",ExpressionUUID->"5cde0a61-02fb-4116-a9cf-f8b916b5c311"],
Cell[CellGroupData[{
Cell[15223, 295, 154, 3, 67, "Subsection",ExpressionUUID->"649d32dd-4b8c-4dfc-886b-8d55243627d8"],
Cell[15380, 300, 1410, 21, 37, "Input",ExpressionUUID->"82d30892-f492-49bc-83d8-dbf01bf8d67c"],
Cell[16793, 323, 1211, 18, 37, "Input",ExpressionUUID->"45349718-3cfd-4feb-92d9-e2c33ee46fc4"],
Cell[18007, 343, 563, 13, 37, "Input",ExpressionUUID->"d98f3c55-d356-45ad-aaf4-e85fb33c1432"],
Cell[18573, 358, 634, 16, 37, "Input",ExpressionUUID->"75f78d58-769a-478e-82a5-a56db2e2eae8"],
Cell[19210, 376, 1512, 22, 37, "Input",ExpressionUUID->"95eaf88e-712a-45e9-b401-8cb94cee40b5"],
Cell[20725, 400, 1267, 19, 37, "Input",ExpressionUUID->"2d026e76-f2cf-4574-b745-5ce4b74960b9"],
Cell[21995, 421, 679, 15, 37, "Input",ExpressionUUID->"fde0d3d4-a7ab-40db-8385-ce3b1ed80912"],
Cell[22677, 438, 696, 16, 37, "Input",ExpressionUUID->"7bd4d3b3-3bb6-4122-9983-169709b524f6"],
Cell[CellGroupData[{
Cell[23398, 458, 283, 6, 37, "Input",ExpressionUUID->"4ef3fab6-4387-4767-a04d-374ee07b4ede"],
Cell[23684, 466, 2765, 62, 42, "Output",ExpressionUUID->"0014821e-9f81-481c-b0cd-429388538ea1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26498, 534, 153, 3, 67, "Subsection",ExpressionUUID->"48e7ced9-6a91-4421-bc3b-202d711bd2d9"],
Cell[26654, 539, 304, 7, 37, "Input",ExpressionUUID->"0ab072a1-6e4c-4471-9f9d-9724bca0479d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27007, 552, 213, 4, 84, "Section",ExpressionUUID->"d683a946-b8e9-4a07-9345-63c8a99db9b9"],
Cell[27223, 558, 4275, 105, 298, "Input",ExpressionUUID->"13cb0ae0-c5f6-4cd3-b9dd-3e3aa6827fdd"],
Cell[CellGroupData[{
Cell[31523, 667, 401, 7, 37, "Input",ExpressionUUID->"e4e01b5b-b05b-49d7-9beb-18be3599f4f4"],
Cell[31927, 676, 2769, 45, 121, "Output",ExpressionUUID->"9ffaa08b-1619-45fc-bf21-4713b076a627"]
}, Open  ]],
Cell[34711, 724, 889, 24, 37, "Input",ExpressionUUID->"284914c1-35e0-477c-8102-2c911e571007"],
Cell[CellGroupData[{
Cell[35625, 752, 227, 3, 37, "Input",ExpressionUUID->"c754de68-ce8f-4e5e-9366-4af0251169d6"],
Cell[35855, 757, 453, 8, 42, "Output",ExpressionUUID->"d44d6c92-32e9-4160-8a96-2ddbc8e3c243"]
}, Open  ]],
Cell[36323, 768, 747, 20, 37, "Input",ExpressionUUID->"0fd5e0ba-0381-4f72-80de-512131ad5b4e"],
Cell[CellGroupData[{
Cell[37095, 792, 243, 4, 37, "Input",ExpressionUUID->"50f75f13-d8d8-4824-8cea-3474bef02370"],
Cell[37341, 798, 8464, 160, 381, "Output",ExpressionUUID->"7b603005-c807-43d2-806a-c65f7a4fc8b3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45854, 964, 168, 3, 84, "Section",ExpressionUUID->"70fea9cb-924c-494c-bc2c-0447ccda8147"],
Cell[46025, 969, 1481, 36, 142, "Input",ExpressionUUID->"12cf08df-1562-4805-ae94-ba41065866cd"],
Cell[CellGroupData[{
Cell[47531, 1009, 288, 4, 37, "Input",ExpressionUUID->"b27f4e68-7f06-4a25-81b7-1ea8c9319ca8"],
Cell[47822, 1015, 6666, 102, 329, "Output",ExpressionUUID->"a38bc562-c68b-4164-8d26-5ade8358a7ed"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54537, 1123, 271, 4, 84, "Section",ExpressionUUID->"bbfe827f-2fa6-490f-a91d-9403d107ceec"],
Cell[CellGroupData[{
Cell[54833, 1131, 268, 4, 67, "Subsection",ExpressionUUID->"4c4d7567-d092-474f-ace7-62deda3b16a2"],
Cell[55104, 1137, 481, 10, 37, "Input",ExpressionUUID->"68ebe8ee-aa1e-42e7-b357-e299db7e9b1f"],
Cell[CellGroupData[{
Cell[55610, 1151, 261, 5, 37, "Input",ExpressionUUID->"a5a1702b-9cc5-4d2d-a561-37882530ab84"],
Cell[55874, 1158, 807, 14, 42, "Output",ExpressionUUID->"f9b796ac-901f-4655-ab7a-aaf959ff87a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56718, 1177, 346, 9, 37, "Input",ExpressionUUID->"7dbe2c80-22be-4f52-9c05-7471ef8f349b"],
Cell[57067, 1188, 1086, 19, 42, "Output",ExpressionUUID->"601ce908-73f9-4ad4-8227-f9da8b4e3450"]
}, Open  ]],
Cell[58168, 1210, 290, 6, 37, "Input",ExpressionUUID->"087c4f2e-a58d-4afd-bbce-e8e916d45d38"],
Cell[58461, 1218, 524, 14, 37, "Input",ExpressionUUID->"24f01284-a8f6-4a6d-9011-5175fc109979"],
Cell[58988, 1234, 477, 13, 37, "Input",ExpressionUUID->"fed23a48-2bcc-48fa-937f-08fe3bd1a053"],
Cell[59468, 1249, 474, 13, 37, "Input",ExpressionUUID->"59551a0c-066a-4dd2-ba74-e65ec2f7b0d9"],
Cell[59945, 1264, 474, 13, 37, "Input",ExpressionUUID->"10f73b14-1960-4337-b962-36c7b1903226"],
Cell[60422, 1279, 475, 13, 37, "Input",ExpressionUUID->"6bcc7632-43f3-457f-8e19-5a1e05c900c0"],
Cell[60900, 1294, 475, 13, 37, "Input",ExpressionUUID->"c15f36b2-5866-4c3e-9757-22beee090e0f"],
Cell[61378, 1309, 478, 13, 37, "Input",ExpressionUUID->"e5fec561-7b08-4dbc-a705-1c206fac3124"],
Cell[61859, 1324, 481, 13, 37, "Input",ExpressionUUID->"0acee9a6-ddb9-45e6-b138-9e79f4900466"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62377, 1342, 169, 3, 67, "Subsection",ExpressionUUID->"be6ea4af-1e94-4a3c-b86e-2246a7920811"],
Cell[62549, 1347, 627, 12, 37, "Input",ExpressionUUID->"f689bc49-5a7c-465d-8104-ba15bf8516f4"],
Cell[63179, 1361, 434, 11, 37, "Input",ExpressionUUID->"ea4acf7c-5794-4589-904d-b4779d573336"],
Cell[CellGroupData[{
Cell[63638, 1376, 257, 5, 37, "Input",ExpressionUUID->"05251fda-7991-4dcf-9b1b-41260fa2b768"],
Cell[63898, 1383, 832, 13, 42, "Output",ExpressionUUID->"d9244a57-5bea-4825-8292-07320b7b7dbc"]
}, Open  ]],
Cell[64745, 1399, 924, 22, 37, "Input",ExpressionUUID->"28b927fc-0648-48b6-b563-0c91ea8ca55b"],
Cell[65672, 1423, 822, 24, 37, "Input",ExpressionUUID->"dd988052-679c-40d9-afd1-93ad1fa873f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66531, 1452, 236, 4, 67, "Subsection",ExpressionUUID->"b2c3ce97-23f0-4104-9a8a-67c007b4f65a"],
Cell[66770, 1458, 894, 20, 37, "Input",ExpressionUUID->"1f858618-0ec4-4c5c-9b82-e2bb81142648"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67701, 1483, 214, 4, 67, "Subsection",ExpressionUUID->"6f61bbd2-e8fe-4b68-bf2a-22e24e488c1e"],
Cell[67918, 1489, 875, 21, 37, "Input",ExpressionUUID->"ec1becad-1e03-4a76-8318-a40185f1933c"],
Cell[68796, 1512, 342, 7, 37, "Input",ExpressionUUID->"04985015-1959-419f-87f8-d3c0a3972ab7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69187, 1525, 153, 3, 84, "Section",ExpressionUUID->"b7f21430-bc39-4d06-aa31-cad102be6abe"],
Cell[69343, 1530, 547, 11, 37, "Input",ExpressionUUID->"1abeab3a-8903-440a-b316-fdd29a22e347"],
Cell[CellGroupData[{
Cell[69915, 1545, 245, 4, 37, "Input",ExpressionUUID->"5082d2fb-cdfc-42a0-a23a-8cda8c49d2ce"],
Cell[70163, 1551, 1610, 23, 42, "Output",ExpressionUUID->"aba6a409-045d-42ee-ab45-caf517bf5d3f"]
}, Open  ]],
Cell[71788, 1577, 999, 21, 37, "Input",ExpressionUUID->"7d73aaf9-2d24-4e9c-b104-f085f90feb8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72824, 1603, 223, 4, 84, "Section",ExpressionUUID->"6ba7fb4d-398d-47eb-8ad8-321179127414"],
Cell[73050, 1609, 3369, 85, 298, "Input",ExpressionUUID->"3cba45de-e752-4f6f-a6ed-d59a8f73f14e"],
Cell[76422, 1696, 8401, 209, 584, "Input",ExpressionUUID->"f3472e72-08d7-4669-98fb-97ec61f77e22"],
Cell[84826, 1907, 463, 8, 37, "Input",ExpressionUUID->"691865ec-d759-4809-92d8-1432240bf9e2"],
Cell[85292, 1917, 411, 8, 37, "Input",ExpressionUUID->"50975097-35cc-41b7-a61f-8dd9ad0bdc3e"],
Cell[85706, 1927, 563, 10, 37, "Input",ExpressionUUID->"542744e5-7bf7-4ef5-83a6-5f762d8bb2c0"],
Cell[86272, 1939, 501, 9, 37, "Input",ExpressionUUID->"be13f1a2-15f5-43e9-a025-bc04a2cdfd3f"],
Cell[86776, 1950, 502, 9, 37, "Input",ExpressionUUID->"30ee788a-e91e-4c3b-acf0-bfc838636665"],
Cell[87281, 1961, 557, 10, 37, "Input",ExpressionUUID->"50e852f9-94f2-43a3-835a-5d6559c2eabf"],
Cell[87841, 1973, 554, 10, 37, "Input",ExpressionUUID->"870d55ca-a11d-4eeb-aba4-48ab9cf4877c"],
Cell[88398, 1985, 621, 12, 37, "Input",ExpressionUUID->"17eb20e6-0a91-43df-b1d3-cc8daf1731de"],
Cell[89022, 1999, 630, 12, 37, "Input",ExpressionUUID->"deaf45d5-d3d4-43d9-9105-e0dafaa29139"],
Cell[89655, 2013, 866, 22, 64, "Input",ExpressionUUID->"e8b97618-e7b1-4b02-86a2-4ed3cc63091b"],
Cell[CellGroupData[{
Cell[90546, 2039, 686, 13, 37, "Input",ExpressionUUID->"1dd6e8f6-af49-4669-a356-94bac61c85b8"],
Cell[91235, 2054, 1507, 21, 42, "Output",ExpressionUUID->"9ec25bbd-57d1-41e4-8720-d4a2ed792885"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92791, 2081, 166, 3, 84, "Section",ExpressionUUID->"b5b40502-6a9a-4586-8f7c-010641314169"],
Cell[CellGroupData[{
Cell[92982, 2088, 294, 6, 37, "Input",ExpressionUUID->"2e94adcc-6fd3-47aa-bdff-8a0e92c4bdbd"],
Cell[93279, 2096, 414, 8, 42, "Output",ExpressionUUID->"eabb5510-5b1c-4629-99ef-eeec59498977"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93730, 2109, 335, 8, 37, "Input",ExpressionUUID->"e717343d-0a0f-4584-953e-97039536ad00"],
Cell[94068, 2119, 416, 8, 42, "Output",ExpressionUUID->"94efbdb8-9197-4d40-8367-e0811adf2457"]
}, Open  ]],
Cell[94499, 2130, 585, 10, 37, "Input",ExpressionUUID->"15acd896-80dc-4e58-9403-46ca31ed3d84"],
Cell[95087, 2142, 147, 3, 44, "Text",ExpressionUUID->"495d0874-47d7-443e-aea3-f672e57fd22b"],
Cell[95237, 2147, 702, 13, 37, "Input",ExpressionUUID->"22be6d32-b64c-45c4-8c10-d7eb16b0ca98"],
Cell[95942, 2162, 763, 14, 37, "Input",ExpressionUUID->"5a9988b4-3c56-4995-9340-40c12fe62a49"],
Cell[96708, 2178, 777, 15, 37, "Input",ExpressionUUID->"de31a0ed-d181-46cd-991d-31469737e79b"],
Cell[97488, 2195, 146, 3, 44, "Text",ExpressionUUID->"5b59fe7b-9d9f-445c-a28f-d9f330541e92"],
Cell[97637, 2200, 752, 14, 37, "Input",ExpressionUUID->"615b1113-bab5-44be-9664-401a1dba657a"],
Cell[98392, 2216, 807, 14, 37, "Input",ExpressionUUID->"4e505825-3281-452b-86e2-754726066548"],
Cell[99202, 2232, 824, 15, 37, "Input",ExpressionUUID->"1fbb23d1-e1da-4ba1-b17f-d48e9a173d10"],
Cell[100029, 2249, 1712, 38, 116, "Input",ExpressionUUID->"d3d3844f-cb6e-4d31-bd6e-011b4753cc06"],
Cell[CellGroupData[{
Cell[101766, 2291, 743, 13, 37, "Input",ExpressionUUID->"166c5464-0d02-49b2-a869-8de22d26da9e"],
Cell[102512, 2306, 1537, 21, 42, "Output",ExpressionUUID->"056a9739-ad95-4918-bb42-76480980868f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104098, 2333, 252, 4, 84, "Section",ExpressionUUID->"0061e3a7-5b2a-4d90-9b5a-5f2a114900c5"],
Cell[104353, 2339, 179, 3, 44, "Text",ExpressionUUID->"5727d3ef-10e5-4fbc-8364-22b4c1340959"],
Cell[104535, 2344, 8412, 206, 610, "Input",ExpressionUUID->"f405e2dd-43d3-4968-b4ac-97ae4cae5959"],
Cell[112950, 2552, 535, 11, 37, "Input",ExpressionUUID->"f404a1e7-a082-4dfa-8294-fa0221673012"],
Cell[113488, 2565, 929, 21, 64, "Input",ExpressionUUID->"ec57c78e-0689-4977-923d-601f05e85bb7"],
Cell[114420, 2588, 424, 8, 37, "Input",ExpressionUUID->"247e33f0-cd03-415a-ac76-1c533689177d"],
Cell[114847, 2598, 410, 7, 37, "Input",ExpressionUUID->"7dc6550e-9373-4a35-a4b6-ced7f0a13b70"],
Cell[115260, 2607, 464, 8, 37, "Input",ExpressionUUID->"d0be0e3d-ef71-4d60-8a6b-9974b59b9362"],
Cell[115727, 2617, 476, 9, 37, "Input",ExpressionUUID->"7d7fe0d8-84be-48f2-8d68-dd758c03baa1"],
Cell[116206, 2628, 540, 11, 37, "Input",ExpressionUUID->"57d59f0e-a38e-422c-b921-e18279d64b9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116783, 2644, 165, 3, 84, "Section",ExpressionUUID->"18b2f48d-c537-4fb1-83c8-1227aa06dae8"],
Cell[116951, 2649, 569, 11, 37, "Input",ExpressionUUID->"3b885614-f67d-4349-81da-33332ad8bfdd"],
Cell[117523, 2662, 640, 13, 64, "Input",ExpressionUUID->"7f206a50-20f8-4089-97af-863b62b8d526"],
Cell[118166, 2677, 645, 13, 64, "Input",ExpressionUUID->"31d650c0-222e-4a7c-882d-16990bd4ae87"],
Cell[118814, 2692, 879, 15, 37, "Input",ExpressionUUID->"1200698c-4575-4d83-8236-ae799285e083"],
Cell[119696, 2709, 857, 16, 64, "Input",ExpressionUUID->"5b8f3fe2-6526-42eb-934f-cfdb9965f6b8"],
Cell[120556, 2727, 882, 16, 64, "Input",ExpressionUUID->"830cef9e-1b07-47cc-bab2-85ae489ebbb6"],
Cell[121441, 2745, 1830, 38, 116, "Input",ExpressionUUID->"9e78d916-1d55-4ea3-a515-785a0eba0b8f"],
Cell[CellGroupData[{
Cell[123296, 2787, 796, 14, 37, "Input",ExpressionUUID->"ad7048b8-975d-4c78-9ede-7533a5cf20d3"],
Cell[124095, 2803, 1612, 22, 42, "Output",ExpressionUUID->"50a64b2b-deb9-4577-a53c-5447f6eb517a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125756, 2831, 210, 4, 84, "Section",ExpressionUUID->"40ca2e48-16e2-418c-970f-24e2256af33a"],
Cell[125969, 2837, 3479, 85, 298, "Input",ExpressionUUID->"d9c51eee-2dfd-4b4a-8048-3b73e08d69de"],
Cell[129451, 2924, 8611, 212, 584, "Input",ExpressionUUID->"1651b84e-cf0e-4f9b-a35f-f4577a78808e"],
Cell[138065, 3138, 409, 9, 37, "Input",ExpressionUUID->"33cbce4e-13f8-40d1-878f-8febf2e38dbc"],
Cell[138477, 3149, 657, 11, 37, "Input",ExpressionUUID->"bed4037d-197a-4b05-a4e5-5a84138081ae"],
Cell[139137, 3162, 437, 10, 37, "Input",ExpressionUUID->"c83fefb6-1c29-41d6-9438-99b9164d969e"],
Cell[139577, 3174, 757, 12, 91, "Input",ExpressionUUID->"d97d4c89-1680-4575-88b1-ed789bf1daf7"]
}, Open  ]]
}, Open  ]]
}
]
*)

